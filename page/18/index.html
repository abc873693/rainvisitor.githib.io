<!DOCTYPE html>
<html lang="zh-tw,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.rainvisitor.me","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="RainVisitor Blog">
<meta property="og:url" content="https://blog.rainvisitor.me/page/18/index.html">
<meta property="og:site_name" content="RainVisitor Blog">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Rainvisitor">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://blog.rainvisitor.me/page/18/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-tw'
  };
</script>

  <title>RainVisitor Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">RainVisitor Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">RainVisitor</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw,default">
    <link itemprop="mainEntityOfPage" href="https://blog.rainvisitor.me/archives/ca05ef63.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rainvisitor">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RainVisitor Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/archives/ca05ef63.html" class="post-title-link" itemprop="url">【文章翻譯】Integration Testing with flutter_driver</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-29 15:24:10" itemprop="dateCreated datePublished" datetime="2020-09-29T15:24:10+08:00">2020-09-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-09-30 16:55:14" itemprop="dateModified" datetime="2024-09-30T16:55:14+08:00">2024-09-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Flutter/" itemprop="url" rel="index"><span itemprop="name">Flutter</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>【文章內容使用 Gemini 1.5 Pro 自動產生】</p>
<h2 id="使用-flutter-driver-進行整合測試"><a href="#使用-flutter-driver-進行整合測試" class="headerlink" title="使用 flutter_driver 進行整合測試"></a>使用 flutter_driver 進行整合測試</h2><p>單元測試確保應用程式的個別部分按預期運作，但整個應用程式呢？這就是整合測試發揮作用的地方。</p>

<h3 id="Flutter-driver"><a href="#Flutter-driver" class="headerlink" title="Flutter driver"></a>Flutter driver</h3><p>如果您從未在 Flutter（或任何地方）進行過整合測試，別擔心！在 Flutter 中為您的應用程式添加整合測試是一項簡單的任務。有一組非常有用的文章將引導您。</p>

<ol>
<li><a href="https://flutter.dev/docs/cookbook/testing/integration/introduction">整合測試簡介</a>：這個東西是什麼，我該如何設定？</li>
<li><a href="https://flutter.dev/docs/cookbook/testing/integration/scrolling">處理捲動</a>：我該如何處理捲動到某個東西的常見模式？</li>
</ol>

<p>到達這一點可以確保您的應用程式可以正常運行、可以到達特定螢幕、特定操作會產生一些結果，等等。您創建的測試取決於您的需求。您可以使用一個測試打開應用程式的所有螢幕，或者使用測試完成特定使用者旅程。</p>

<p>但我們可以使用 flutter_driver 進一步進行效能測試。</p>

<h3 id="效能分析"><a href="#效能分析" class="headerlink" title="效能分析"></a>效能分析</h3><p>只需將您的測試用 flutterDriver.traceAction 包裹起來，就會在您的測試運行時記錄您的應用程式的效能。此輸出資料（以 JSON 格式）可以在持續整合 (CI) 測試中使用，以確保例如某些指標保持在特定臨界值之上或之下。該資料還可以用於除錯效能問題。有關如何進行效能分析的詳細資訊，請參閱整合測試文章，<a href="https://flutter.dev/docs/cookbook/testing/integration/profiling">效能分析</a>。</p>

<p>作為參考，Flutter Gallery 有個 <a href="https://github.com/flutter/gallery/tree/master/test_driver">整合測試</a>，會瀏覽所有演示並為其中的一部分捕獲效能指標。</p>

<h3 id="螢幕截圖測試"><a href="#螢幕截圖測試" class="headerlink" title="螢幕截圖測試"></a>螢幕截圖測試</h3><p><em>螢幕截圖測試</em>是一種渲染 UI、捕獲輸出螢幕截圖，然後將結果與預期圖片進行比較。為您的應用程式添加螢幕截圖測試的一個簡單方法是使用 flutterDriver.screenshot。若要了解更多資訊並查看實際的程式碼範例，請參閱 Medium 文章，<a href="https://medium.com/flutter-community/testing-flutter-ui-with-flutter-driver-c1583681e337#8561">使用 Flutter Driver 測試 Flutter UI</a>，作者是社群成員 Darshan Kawar。</p>

<p>此方法可以輕鬆整合到您的持續整合測試設定中，以防止 UI 回歸。Flutter Gallery 有幾個 <a href="https://github.com/flutter/gallery/tree/master/golden_test">螢幕截圖測試</a> 和一個 <a href="https://github.com/flutter/gallery/blob/master/.github/workflows/golden.yml">GitHub 工作流程設定</a>，用於自動測試進來的 PR。</p>

<iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/3821c3795913217d187d26b04dbdc1a4/href">https://medium.com/media/3821c3795913217d187d26b04dbdc1a4/href</a></iframe>

<h3 id="a11y-測試"><a href="#a11y-測試" class="headerlink" title="a11y 測試"></a>a11y 測試</h3><p><em>a11y</em> 或無障礙測試是一種可用性測試，用於確保應用程式可以被有障礙的人使用，例如視力障礙、聽力障礙、肢體障礙，等等。使用 flutterDriver.getSemanticsId 驗證語義標籤，例如，驗證所有圖片是否都有語義標籤。</p>

<iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/9712bbcd895e55e14cb2ede49659854b/href">https://medium.com/media/9712bbcd895e55e14cb2ede49659854b/href</a></iframe>

<p>在 Darshan Kawar 的另一篇很棒的文章中，了解更多關於無障礙測試的資訊，<a href="https://medium.com/flutter-community/developing-and-testing-accessible-app-in-flutter-1dc1d33c7eea">在 Flutter 中開發和測試無障礙應用程式</a>。</p>

<h3 id="i18n-測試"><a href="#i18n-測試" class="headerlink" title="i18n 測試"></a>i18n 測試</h3><p><em>i18n</em> 或國際化測試是測試應用程式是否可以在不同的語言和地區使用而無需任何變更的過程。</p>

<p>根據您的本地化程式碼的設定方式，您可以使用本地化的委派來更改語言環境。</p>

<pre>ExampleAppLocalizationsDelegate.load(Locale('fr'));</pre>

<p>或者，在使用 MaterialApp 時，只需允許覆蓋應用程式的語言環境，以便在不同的語言環境中運行。</p>

<iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/faf86fe011e8553d226ef1e531f6bb2c/href">https://medium.com/media/faf86fe011e8553d226ef1e531f6bb2c/href</a></iframe>

<p>在啟動應用程式的驅動程式檔案中，設定語言環境。</p>

<iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/e56e6c3f196adf5990428f6f77a79e9e/href">https://medium.com/media/e56e6c3f196adf5990428f6f77a79e9e/href</a></iframe>

<h3 id="額外提示"><a href="#額外提示" class="headerlink" title="額外提示"></a>額外提示</h3><p>想知道頁面上是否存在某個元素嗎？</p>

<iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/7bc1030109a119c1862a5dc5513e34ea/href">https://medium.com/media/7bc1030109a119c1862a5dc5513e34ea/href</a></iframe>

<p>您可以選擇任何適合您的應用程式的超時時間。</p>

<h3 id="結語"><a href="#結語" class="headerlink" title="結語"></a>結語</h3><p>到目前為止，您應該對 flutter_driver 的功能有了很好的了解。您可以結合方法以滿足您的需求；例如，使用不同的語言環境執行螢幕截圖測試。如果我們遺漏了什麼，請在評論中告訴我們！若要了解更多資訊，請參閱 <a href="https://api.flutter.dev/flutter/flutter_driver/flutter_driver-library.html">flutter_driver</a> API 文件。</p>

<p><em>關於作者：Pierre-Louis 是滑鐵盧大學的應屆大學畢業生。他住在慕尼黑，是維護 Flutter Material 函式庫的團隊中的一員。他對 UI、UX 和應用程式開發非常感興趣。您可以在</em> <a href="https://www.linkedin.com/in/guidezpl"><em>LinkedIn</em></a><em> 和</em> <a href="https://github.com/guidezpl"><em>GitHub</em></a><em> 上與他聯繫。</em></p>

<p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=36f66ede5cf2" width="1" height="1" alt=""><hr><p><a href="https://medium.com/flutter/integration-testing-with-flutter-driver-36f66ede5cf2">使用 flutter_driver 進行整合測試</a> 最初發佈在 <a href="https://medium.com/flutter">Flutter</a> 上的 Medium，人們在那裡透過突出顯示和回應這個故事來繼續討論。</p></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw,default">
    <link itemprop="mainEntityOfPage" href="https://blog.rainvisitor.me/archives/2a1bf84b.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rainvisitor">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RainVisitor Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/archives/2a1bf84b.html" class="post-title-link" itemprop="url">【文章翻譯】Announcing Flutter Windows Alpha</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-23 14:57:38" itemprop="dateCreated datePublished" datetime="2020-09-23T14:57:38+08:00">2020-09-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-09-30 16:55:14" itemprop="dateModified" datetime="2024-09-30T16:55:14+08:00">2024-09-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Flutter/" itemprop="url" rel="index"><span itemprop="name">Flutter</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>【文章內容使用 Gemini 1.5 Pro 自動產生】</p>
<h2 id="宣布-Flutter-Windows-Alpha-版本"><a href="#宣布-Flutter-Windows-Alpha-版本" class="headerlink" title="宣布 Flutter Windows Alpha 版本"></a>宣布 Flutter Windows Alpha 版本</h2><p>我們的使命是為開發人員提供一個開源、高生產力的框架，用於在任何平台上構建美觀的原生應用程式。到目前為止，我們已經為 Android 和 iOS 發佈了生產級別的支援，擁有 8 個穩定版本，僅 Google Play 商店就發佈了超過 100,000 個應用程式。我們繼續擴大我們的關注範圍，包括其他平台，包括網頁、macOS 和 Linux。今天，我們很高興宣布 Flutter 的另一個目標是為 Windows 發佈 Flutter 支援的 alpha 版本。</p>
<p>Windows 仍然是桌面和筆記型電腦設備的熱門選擇，微軟報告稱 <a href="https://blogs.windows.com/windowsexperience/2020/03/16/windows-10-powering-the-world-with-1-billion-monthly-active-devices/">超過 10 億台設備運行 Windows 10</a>。我們自己的統計數據顯示，超過一半的 Flutter 開發人員使用 Windows，因此它自然成為 Flutter 的目標。原生桌面支援為 Flutter 開啟了各種令人興奮的可能性，包括改進的開發人員工具、降低新使用者的摩擦，當然還有可以從單個程式碼庫到達使用者可能擁有的任何設備的應用程式。</p>
<h3 id="將-Windows-加入-Flutter"><a href="#將-Windows-加入-Flutter" class="headerlink" title="將 Windows 加入 Flutter"></a>將 Windows 加入 Flutter</h3><p>如我們的 <a href="https://flutter.dev/docs/resources/architectural-overview">架構概述</a> 中所述，Flutter 是一個跨平台 UI 工具包，旨在允許在 iOS 和 Android 等操作系統之間重複使用程式碼，同時也允許應用程式直接與底層平台服務進行互動。目標是讓開發人員能夠交付高效能的應用程式，這些應用程式在不同的平台上感覺自然，在存在差異的地方擁抱差異，同時盡可能共享程式碼。Flutter 的核心是引擎，它支援支援所有 Flutter 應用程式所必需的基本元素。引擎負責在需要繪製新畫面時對合成場景進行光柵化。它提供了 Flutter 核心 API 的低階實作，包括圖形、文字佈局、檔案和網路 I&#x2F;O、輔助功能支援、外掛架構，以及 Dart 執行時和編譯工具鏈。</p>
<p>我們添加到 Flutter 的每個新平台都會使用新的服務擴展核心框架，以便它在該平台上發光。我們從 Android 和 iOS 開始，採用 Material Design 以及基於觸控的、以行動為中心的使用者介面，該介面旨在讓兩個行動平台上的像素完美。為網頁、Windows、macOS 和 Linux 添加對桌面外觀尺寸的支援帶來了全新的服務集，包括對鍵盤、滑鼠、滑鼠滾輪和控制器（輸入端）的強大支援，以及在網頁和桌面應用程式附帶的較大螢幕尺寸上適應或甚至最有效工作的 Widget。</p>
<p>此外，每個新平台不僅會影響 Flutter 框架和引擎，還會影響許多其他方面：</p>
<ul>
<li><strong>工具鏈更新：</strong>將新目標添加到 CLI 和 IDE 工具（在本例中為 Windows）</li>
<li><strong>外殼程式：</strong>支援透過 WM_* 訊息處理來自 Windows 的輸入，以及透過 <a href="https://opensource.google/projects/angle">ANGLE</a> 輸出，ANGLE 使用 <a href="https://skia.org/">Skia</a> 以原生速度渲染到底層 DirectX 表面</li>
<li><strong>執行器：</strong>每個專案都有一個外殼程式應用程式，適用於受支援的目標。對於 Windows，它是一個載入您的 Flutter 程式碼並在執行時執行的 Win32&#x2F;C++ 程式。如果您需要，這是將原生程式碼添加到您的應用程式的好地方。</li>
<li><strong>外掛：</strong>外掛是 Dart 程式碼和原生程式碼的混合，適用於外掛支援的每個平台。需要為編譯到 Windows 上的 Flutter 應用程式中的每個外掛添加該原生程式碼。</li>
</ul>
<p>此 alpha 版本提供了堅實的基礎，我們將在接下來的幾個月內將其穩定下來。透過對 Windows 7 及更高版本的支援，我們希望這能讓具有冒險精神的開發人員擁有一些可以開始使用的東西。</p>
<h3 id="探索一些範例應用程式"><a href="#探索一些範例應用程式" class="headerlink" title="探索一些範例應用程式"></a>探索一些範例應用程式</h3><p>若要查看 Flutter 對 Windows 的支援，您可能需要嘗試一些我們建立的範例應用程式，這些應用程式在我們的最新支援下可以在 Windows 上良好運行。第一個是 Flokk 應用程式，它是與 <a href="http://gskinner.com/">gskinner.com</a> 的設計師和開發人員共同建立的。目標是透過建立一個創新的、美觀的 Flutter 桌面應用程式來證明 Flutter 已經準備好迎接桌面。Flokk 是一個與您的真實 Google 聯繫人資料配合使用的應用程式，同時還顯示了您的聯繫人在 GitHub 和 Twitter 上的活動。</p>
<figure>
<img alt="" src="https://cdn-images-1.medium.com/max/1024/0*39MKtw4ICepbL_8d" />
</figure>

<p>如果您想在 Windows 電腦上使用 Flokk 應用程式，您可以 <a href="https://github.com/gskinnerTeam/Flokk/releases">在 GitHub 上下載最新版本</a>。如果您想了解 gskinner 如何構建這個應用程式，請參閱他們的出色部落格文章：<a href="https://blog.gskinner.com/archives/2020/09/flokk---how-we-built-a-desktop-app-using-flutter.html">Flokk - 我們如何使用 Flutter 建立桌面應用程式</a>。</p>
<p>此外，Flutter Gallery 應用程式（我們用於所有 Flutter 事物的展示應用程式）最近已完全重寫，以添加對桌面外觀尺寸的支援。這讓我們可以檢查它在 <a href="https://gallery.flutter.dev/">網頁</a> 以及 Windows、macOS 和 Linux 上是否運行良好。</p>
<figure>
<img alt="" src="https://cdn-images-1.medium.com/max/1024/0*N_tKeqs435R4yICO" />
</figure>

<p>Gallery 中的許多研究展示了我們在使用 Flutter 設計自己的 Windows 應用程式時推薦的不同應用程式樣式的想法。當您找到喜歡的內容時，<a href="https://github.com/flutter/gallery">程式碼可在 GitHub 上獲得</a>。</p>
<h3 id="開始使用-Flutter-for-Windows"><a href="#開始使用-Flutter-for-Windows" class="headerlink" title="開始使用 Flutter for Windows"></a>開始使用 Flutter for Windows</h3><p>按照 <a href="https://flutter.dev/docs/get-started/install/windows">Windows 安裝說明</a> 安裝 Flutter SDK 以開始。若要以 Windows 桌面為目標，您首先需要 <a href="https://flutter.dev/desktop#additional-windows-requirements">安裝桌面文件中描述的工具</a>。預設情況下，Flutter 假設您正在構建生產軟體，並且沒有配置為開發 Windows 應用程式。但是，這可以輕鬆地從命令行中修復：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ flutter channel dev</span><br><span class="line">$ flutter upgrade</span><br><span class="line">$ flutter config --enable-windows-desktop</span><br></pre></td></tr></table></figure>

<p>第一個命令將 Flutter 設定為使用實驗性品質的「dev」頻道（而不是預設的「stable」頻道）。這讓您可以使用仍處於 alpha 階段的平台支援，例如 Windows。第二個命令會在該頻道上提取最新的位元。第三個命令會在您的電腦上啟用 Windows 應用程式開發。</p>
<p>設定好之後，每次您使用 Android Studio 或 Visual Studio Code 的擴展支援，或者從命令行建立新的 Flutter 應用程式時，它都會建立一個 windows 子資料夾。</p>
<figure>
<img alt="" src="https://cdn-images-1.medium.com/max/1024/0*O-akivVSsv0tL0wI" />
</figure>

<p>如果您感到好奇，在 Windows 上運行預設應用程式看起來像這樣：</p>
<figure>
<img alt="" src="https://cdn-images-1.medium.com/max/838/1*fsnlPFkpQWZjYIv-NCE6Vg.png" />
</figure>

<p>最後，建立應用程式後，構建它會建立一個發佈模式的原生 EXE 檔案以及必要的支援 DLL。在那之後，如果您想嘗試在任何 Windows 10 電腦上運行您的新 Windows 應用程式，甚至那些沒有安裝 Flutter 的電腦，您可以 <a href="https://flutter.dev/desktop#distribution">按照將必要檔案壓縮成壓縮檔的步驟</a> 進行操作。</p>
<h3 id="Windows-的外掛"><a href="#Windows-的外掛" class="headerlink" title="Windows 的外掛"></a>Windows 的外掛</h3><p>儘管我們才剛剛達到 alpha 版本，但 Flutter 社群已經開始為 Windows 開發外掛。這裡有一些：</p>
<ul>
<li><a href="https://pub.dev/packages/url_launcher">url_launcher</a>：從您的應用程式啟動瀏覽器中的 URL</li>
<li><a href="https://pub.dev/packages/path_provider">path_provider</a>：查找使用者電腦上特殊位置（如文件或臨時文件）的路徑</li>
<li><a href="https://pub.dev/packages/shared_preferences">shared_preferences</a>：在您的應用程式會話之間將使用者偏好設定序列化到磁碟上</li>
<li><a href="https://pub.dev/packages/biometric_storage">biometric_storage</a>：透過生物識別資訊加密的儲存</li>
<li><a href="https://pub.dev/packages/flutter_audio_desktop">flutter_audio_desktop</a>：從您的桌面應用程式播放音訊</li>
</ul>
<p>使用這些外掛的好處是，它們中的大多數也支援其他 Flutter 平台，這使您可以將應用程式定位到 Android、iOS、網頁等以及 Windows。此外，儘管 <a href="http://pub.dev/">pub.dev</a>（Dart 和 Flutter 的套件管理器）上約三分之一的可用套件是包含平台特定程式碼的外掛，但大多數卻不是。例如，<a href="https://pub.dev/flutter/favorites">許多品質最高、使用最廣泛的套件</a> 是 Flutter Favorite 程式的一部分，它們中的大多數都在 Windows 上運行。如果您想查看在 Windows 上運行的套件的完整列表，您可以 <a href="https://pub.dev/flutter/packages?platform=windows">在 pub.dev 上運行此查詢</a>。</p>
<h3 id="與-Windows-互操作"><a href="#與-Windows-互操作" class="headerlink" title="與 Windows 互操作"></a>與 Windows 互操作</h3><p>如果您想為 Windows 建立自己的外掛，您可以。在您位於 dev 頻道並為您的電腦啟用 Windows 後，您可以使用以下命令開始：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ flutter create --template plugin --platforms windows hello_plugin</span><br></pre></td></tr></table></figure>

<p>在那之後，您就可以將 Flutter 程式碼添加到外掛專案中的 lib 子資料夾，以及將 Windows 程式碼添加到 Windows 子資料夾中。您將透過 <a href="https://flutter.dev/docs/development/platform-integration/platform-channels">平台通道</a> 在兩個堆疊之間進行通訊，平台通道本質上是 Dart 和 C++ 程式碼之間的訊息傳遞。若要查看此方面的精心製作的範例，請 <a href="https://github.com/flutter/plugins/tree/master/packages/url_launcher/url_launcher_windows">查看 url_launcher 實作</a>。</p>
<p>但是，平台通道並不是您與 Windows 互操作的唯一選擇。如果您願意，可以使用 <a href="https://flutter.dev/docs/development/platform-integration/c-interop">Dart FFI（外部函數介面）</a> 來載入函式庫並呼叫 C 樣式的 API，例如 Win32 API。與使用平台通道的 url_launcher 不同，path_provider 外掛是使用 FFI 實作的，如您在 <a href="https://github.com/flutter/plugins/tree/master/packages/path_provider/path_provider_windows">GitHub 儲存庫</a> 中看到的那樣。FFI 不需要在 Dart 和 C++ 之間來回切換，它讓您能夠撰寫程式碼來直接匯入您想要的 API。例如，以下是呼叫 MessageBox API 的程式碼：</p>
<iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/b635c5481c5c0f1ab18e10657790d617/href">https://medium.com/media/b635c5481c5c0f1ab18e10657790d617/href</a></iframe>

<p>此程式碼不會像平台通道那樣在兩個執行緒之間轉換時產生額外的開銷。FFI 包括對許多不同類型的 API 的支援，包括 Win32、WinRT 和 COM。但在您開始運作並封裝整個基於 C 的 Windows API 之前，請查看 <a href="https://pub.dev/packages/win32">win32 外掛</a>，它已經在進行這項工作。事實上，<a href="https://pub.dev/packages/path_provider">path_provider</a> 外掛本身是使用 win32 外掛實作的。有關 win32 外掛的開發方式及其運作方式的詳細資訊，請查看部落格文章：<a href="https://medium.com/@timsneath/windows-fun-with-dart-ffi-687c4619e78d">使用 Dart FFI 的 Windows 樂趣</a>。</p>
<h3 id="Flutter-for-Windows-資源"><a href="#Flutter-for-Windows-資源" class="headerlink" title="Flutter for Windows 資源"></a>Flutter for Windows 資源</h3><p>無論您在 Flutter for Windows 之旅中處於哪個階段，您都應該確保 <a href="http://flutter.dev/desktop">閱讀 flutter.dev 上的桌面文件</a>，其中包括最新的詳細資訊。此外，您還需要嘗試使用 Flutter <a href="https://codelabs.developers.google.com/codelabs/flutter-github-graphql-client">用於撰寫以 Windows、macOS 和 Windows 桌面為目標的應用程式的 Codelab</a>，其中包含用於實際情況的程式碼，例如使用 OAuth進行身份驗證、存取 GitHub API 以及使用 GraphQL。或者，若要查看另一個在 Windows 上運行的 Flutter 桌面程式碼的好範例，請 <a href="https://github.com/flutter/samples/tree/master/experimental/desktop_photo_search">查看 Photo Search 範例</a>。</p>
<figure>
<img alt="" src="https://cdn-images-1.medium.com/max/816/0*3OlPPAMAvO84mJ6M" />
</figure>

<p>它使用標準的 Windows 檔案開啟對話方塊、樹狀檢視 Widget、分割器 Widget，並將結果與實際的 REST API 整合。</p>
<p>對於其他有用的以桌面為導向的 Widget，我們建議使用 <a href="https://github.com/google/flutter-desktop-embedding/tree/master/plugins/menubar">menubar 外掛</a>、<a href="https://api.flutter.dev/flutter/material/NavigationRail-class.html">NavigationRail Widget</a> 和 <a href="https://api.flutter.dev/flutter/material/DataTable-class.html">DataTable Widget</a>。您可能也對 <a href="https://api.flutter.dev/flutter/widgets/InteractiveViewer-class.html">InteractiveViewer Widget</a> 感興趣，它對滑鼠手勢（用於平移和縮放子 Widget）提供了完整的桌面支援。</p>
<p>另一組有用的 Widget 可以探索的是來自 <a href="https://pub.dev/publishers/syncfusion.com/packages">SyncFusion</a> 的 Widget，SyncFusion 在 Windows 開發社群中已經很有名。他們提供了大量企業級品質的 Widget，用於建立圖表、量規、資料網格等等。</p>
<figure>
<img alt="" src="https://cdn-images-1.medium.com/max/1024/0*dY1TC_i0KyjKNrvh" />
</figure>

<p>這些 Widget 具有社群和企業許可證，因此您可以為您的專案找到合適的選項。</p>
<h3 id="Flutter-for-Windows-的實際應用"><a href="#Flutter-for-Windows-的實際應用" class="headerlink" title="Flutter for Windows 的實際應用"></a>Flutter for Windows 的實際應用</h3><p>除了 Windows 的套件和外掛（以及總體上的 Flutter 桌面）之外，Flutter 開發人員也一直在構建很棒的應用程式來以 Windows 為目標，例如來自 <a href="https://www.invoiceninja.com/">Invoice Ninja</a> 的這個實驗性版本：</p>
<figure>
<img alt="" src="https://cdn-images-1.medium.com/max/1024/0*ZuwlwG4e6fwCeQ_1" />
</figure>

<p>Invoice Ninja 是一家發票公司，它依賴 Flutter 來帶來收入。他們目前在生產環境中以 Android 和 iOS 為目標，並且為您提供了一個可以嘗試的 <a href="https://demo.invoiceninja.com/">基於網頁的演示</a>，但他們也展望著提供桌面版本。</p>
<blockquote>“在 Invoice Ninja，我們過去一直努力僅支援網頁和行動，一度維護了三個獨立的程式碼庫。使用 Flutter，更近一步使用 Flutter 桌面，我們已經能夠使用單個程式碼庫為所有主要平台構建應用程式。我們不僅基本獲得了應用程式的免費桌面版本，而且它的效能也最佳！”</blockquote>

<blockquote>— Hillel Coren，Invoice Ninja 的共同創辦人</blockquote>

<p>如果您對實作在行動和桌面外觀尺寸上運行的實際、產生收入的 Flutter 應用程式感興趣，<a href="https://github.com/invoiceninja/flutter-client">程式碼可在 GitHub 上獲得</a>。</p>
<p><a href="https://drone-detection-system.com/">Aartos</a> 是另一家正在構建很棒的產品的公司，包括一個使用 <a href="https://drone-detection-system.com/aartos-dds/product-overview/">Flutter 撰寫的多平台客戶端</a> 的即時無人機偵測系統。以下是一個早期版本的 Windows 客戶端，它與行動客戶端並排運行：</p>
<iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FmGvPCT7Vc2Y%3Ffeature%3Doembed&amp;display_name=YouTube&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DmGvPCT7Vc2Y&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FmGvPCT7Vc2Y%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" width="854" height="480" frameborder="0" scrolling="no"><a href="https://medium.com/media/38e6826574e5d1090eb7a453f02c2480/href">https://medium.com/media/38e6826574e5d1090eb7a453f02c2480/href</a></iframe>

<p>這兩個版本都以 iOS 和 Windows 為目標，共享完全相同的程式碼庫。</p>
<p>如果您是經驗豐富的 Flutter 開發人員，並且發現自己經常在不同版本的 Flutter 之間切換；例如，一個版本用於發佈您的生產行動應用程式，另一個版本用於嘗試 Windows alpha 版本，那麼您可能會喜歡 Flutter 版本管理器，Flutter 版本管理器現在附帶了 <a href="https://github.com/leoafarias/fvm/releases">可以下載的 Windows GUI</a>。</p>
<iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2F_WA71wSt2ww%3Ffeature%3Doembed&amp;display_name=YouTube&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D_WA71wSt2ww&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2F_WA71wSt2ww%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" width="640" height="480" frameborder="0" scrolling="no"><a href="https://medium.com/media/b310e5f337134761f21ce3e179076a42/href">https://medium.com/media/b310e5f337134761f21ce3e179076a42/href</a></iframe>

<p>這個工具是開源的，因此您可以 <a href="https://github.com/leoafarias/fvm">親眼看看</a> Leo 如何讓它看起來如此棒。</p>
<h3 id="未來展望"><a href="#未來展望" class="headerlink" title="未來展望"></a>未來展望</h3><p>現在我們已經發佈了 alpha 版本，我們的注意力將轉移到完成功能集並穩定產品以供發佈。作為一個開源專案，您可以在我們的 <a href="https://github.com/flutter/flutter/projects/55">GitHub 網站上追踪我們的貝他版進度</a>，其中包括需要完成的剩餘工作，包括輔助功能、全球化和本地化、增強的鍵盤和文字處理、對命令行參數的支援等等。</p>
<p>除了支援經典的 Win32 API 之外，我們還在嘗試 <a href="https://docs.microsoft.com/en-us/windows/uwp/get-started/universal-application-platform-guide">基於 UWP 的 Flutter 外殼版本</a>，這讓 Flutter 可以到達更多種類的基於 Windows 的設備，包括 Xbox。作為該實驗的一部分，本週我們向 Windows 商店發佈了一個基於 UWP 的 <a href="https://www.microsoft.com/en-us/p/flutter-gallery/9pdwctdfc7qq">Flutter Gallery 版本</a>。</p>
<p>以下螢幕截圖顯示了基於 UWP 的 Flutter Gallery 在 Xbox 上運行：</p>
<figure>
<img alt="" src="https://cdn-images-1.medium.com/max/1024/0*cNcLDSm8fwlwux15" />
</figure>

<p>以下是在運行 <a href="https://docs.microsoft.com/en-us/dual-screen/windows/get-dev-tools">Windows 10X 模擬器</a> 的雙螢幕 Windows 設備上運行的相同應用程式：</p>
<figure>
<img alt="" src="https://cdn-images-1.medium.com/max/1024/1*ZIxhg4Lx_KI5v4bc1zi5zg.png" />
</figure>

<p><a href="https://github.com/flutter/flutter/issues/14967#issuecomment-697108439">您可以在 GitHub 上閱讀更多有關 Flutter for UWP 進度</a>。</p>
<h3 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h3><p>透過此版本，我們將 Flutter 的強大功能帶到了 Windows，它具有用於開發人員生產力的宣告式、可組合、反應式框架，以及 Material 規格的適應性實作，因此您可以讓應用程式以您想要的方式呈現和感覺，以及完整的 Flutter 開發和除錯工具集。完成後，您的應用程式將編譯為原生 64 位程式碼，您可以像任何其他原生應用程式一樣將其封裝並帶到其他 Windows 電腦。最後，您可以使用相同的程式碼庫來建立一個以 Android、iOS、網頁、macOS 和 Linux 為目標的應用程式。</p>
<p>如果您想開始使用 Flutter 建立 Windows 應用程式，我們非常歡迎您的 <a href="https://github.com/flutter/flutter/issues">回饋</a>！如果您想使用您的 Windows 專業知識來 <a href="https://flutter.dev/docs/development/packages-and-plugins/developing-packages#plugin">構建熱門外掛的 Windows 實作</a>，或者為 Flutter 建立一些以 Windows 為中心的工具（也許是一個從 flutter build windows 命令的輸出建立 MSIX 的 CLI…），也非常歡迎！</p>
<p>有了 Flutter 對 Windows 的新支援，您打算構建什麼？</p>
<p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=33982cd0f433" width="1" height="1" alt=""><hr><p><a href="https://medium.com/flutter/announcing-flutter-windows-alpha-33982cd0f433">宣布 Flutter Windows Alpha</a> 最初發佈在 <a href="https://medium.com/flutter">Flutter</a> 上的 Medium，人們在那裡透過突出顯示和回應這個故事來繼續討論。</p> </p>
<p><a href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw,default">
    <link itemprop="mainEntityOfPage" href="https://blog.rainvisitor.me/archives/ab96634a.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rainvisitor">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RainVisitor Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/archives/ab96634a.html" class="post-title-link" itemprop="url">【文章翻譯】Handling Web Gestures in Flutter</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-21 13:31:41" itemprop="dateCreated datePublished" datetime="2020-09-21T13:31:41+08:00">2020-09-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-09-30 16:55:14" itemprop="dateModified" datetime="2024-09-30T16:55:14+08:00">2024-09-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Flutter/" itemprop="url" rel="index"><span itemprop="name">Flutter</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>【文章內容使用 Gemini 1.5 Pro 自動產生】</p>
<h2 id="在-Flutter-中處理網頁手勢"><a href="#在-Flutter-中處理網頁手勢" class="headerlink" title="在 Flutter 中處理網頁手勢"></a>在 Flutter 中處理網頁手勢</h2><figure>
<img alt="" src="https://cdn-images-1.medium.com/max/1024/1*BzcKF4qdbLIFFB6XL8x-9A.png" />
</figure>

<p>Flutter 發佈了網頁支援，讓您可以建立動態網站。有了 Flutter 網頁、MacOS、Linux 和 Windows 作業系統（甚至在連接到滑鼠、鍵盤或其他週邊設備的行動裝置上），您現在可以存取平台特定行為，包括焦點支援、鍵盤輸入、自訂滑鼠游標和懸停輸入。但是，您如何在 Flutter 中使用這些平台行為呢？</p>
<p>本文說明如何使用 <code>FocusableActionDetector</code> Widget，它處理鍵盤輸入、焦點輸入、懸停輸入和自訂滑鼠游標。</p>
<h3 id="如何使用-FocusableActionDetector-Widget"><a href="#如何使用-FocusableActionDetector-Widget" class="headerlink" title="如何使用 FocusableActionDetector Widget"></a>如何使用 <code>FocusableActionDetector</code> Widget</h3><p><code>FocusableActionDetector</code> Widget 允許您處理幾個網頁特定動作，包括：</p>
<ol>
<li>鍵盤輸入</li>
<li>焦點輸入</li>
<li>懸停輸入</li>
<li>自訂滑鼠游標</li>
</ol>
<p>在 <a href="https://dartpad.dev/d16345202d0e26d40fe14904657dc24a">DartPad #1</a> 範例中查看 <code>FocusableActionDetector</code> 的實際應用。</p>
<blockquote>**注意：**本文使用了兩個 DartPad 範例，儘管每個範例都有多個連結。[DartPad #1](https://dartpad.dev/d16345202d0e26d40fe14904657dc24a) 展示了 `FocusableActionDetector` 範例，而 [DartPad #2](https://dartpad.dev/5544c57e20454fe212e3ec5cf10b1f0a) 展示了 `FocusableActionDetector` 的懸停和焦點支援。</blockquote>

<h3 id="鍵盤輸入"><a href="#鍵盤輸入" class="headerlink" title="鍵盤輸入"></a>鍵盤輸入</h3><p>Flutter 允許您定義自訂動作來處理鍵盤輸入。假設您想要有一個隱藏的選單，或者您的應用程式必須處理大量的自訂鍵盤輸入。使用 <code>FocusableActionDetector</code> Widget 很容易做到這一點。</p>
<p>首先，加入以下匯入：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/services.dart&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>接下來，從調用 <code>FocusableActionDetector</code> 的類別中，初始化兩個私有變數。這些變數將鍵盤輸入映射到所需的動作：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Map</span>&lt;LogicalKeySet, Intent&gt; _shortcutMap;</span><br></pre></td></tr></table></figure>

<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Map</span>&lt;<span class="built_in">Type</span>, Action&lt;Intent&gt;&gt; _actionMap;</span><br></pre></td></tr></table></figure>

<p>定義一個 <code>FocusableActionDetector</code> Widget。請注意，自訂鍵盤輸入僅在子 Widget 獲得焦點時才會啟用：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FocusableActionDetector(</span><br><span class="line">  actions: _actionMap,</span><br><span class="line">  shortcuts: _shortcutMap,</span><br><span class="line">  child: </span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>此類別將列舉和鍵盤輸入類型映射到 <code>Intent</code> 類別。以下設定是必要的，因為 <code>actions</code> 和 <code>shortcuts</code> 參數需要一個繼承自 <code>Intent</code> 的類別：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_ShowSecretMessageIntent</span> <span class="keyword">extends</span> <span class="title">Intent</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> _ShowSecretMessageIntent(&#123;<span class="meta">@required</span> <span class="keyword">this</span>.type&#125;);</span><br><span class="line">  <span class="keyword">const</span> _ShowSecretMessageIntent.P() : type = _SecretMessageType.P;</span><br><span class="line">  <span class="keyword">const</span> _ShowSecretMessageIntent.L() : type = _SecretMessageType.L;</span><br><span class="line">  <span class="keyword">const</span> _ShowSecretMessageIntent.A() : type = _SecretMessageType.A;</span><br><span class="line">  <span class="keyword">const</span> _ShowSecretMessageIntent.T() : type = _SecretMessageType.T;</span><br><span class="line">  <span class="keyword">const</span> _ShowSecretMessageIntent.F() : type = _SecretMessageType.F;</span><br><span class="line">  <span class="keyword">const</span> _ShowSecretMessageIntent.O() : type = _SecretMessageType.O;</span><br><span class="line">  <span class="keyword">const</span> _ShowSecretMessageIntent.R() : type = _SecretMessageType.R;</span><br><span class="line">  <span class="keyword">const</span> _ShowSecretMessageIntent.M() : type = _SecretMessageType.M;</span><br><span class="line">  <span class="keyword">final</span> _SecretMessageType type;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> _SecretMessageType &#123;</span><br><span class="line">  P,</span><br><span class="line">  L,</span><br><span class="line">  A,</span><br><span class="line">  T,</span><br><span class="line">  F,</span><br><span class="line">  O,</span><br><span class="line">  R,</span><br><span class="line">  M,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 <code>initState</code> 方法中，初始化之前定義的映射：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> initState() &#123;</span><br><span class="line">  _shortcutMap = &lt;LogicalKeySet, Intent&gt;&#123;</span><br><span class="line">    LogicalKeySet(LogicalKeyboardKey.keyP):</span><br><span class="line">      <span class="keyword">const</span> _ShowSecretMessageIntent.P(),</span><br><span class="line">    LogicalKeySet(LogicalKeyboardKey.keyL):</span><br><span class="line">      <span class="keyword">const</span> _ShowSecretMessageIntent.L(),</span><br><span class="line">    LogicalKeySet(LogicalKeyboardKey.keyA):</span><br><span class="line">      <span class="keyword">const</span> _ShowSecretMessageIntent.A(),</span><br><span class="line">    LogicalKeySet(LogicalKeyboardKey.keyT):</span><br><span class="line">      <span class="keyword">const</span> _ShowSecretMessageIntent.T(),</span><br><span class="line">    LogicalKeySet(LogicalKeyboardKey.keyF):</span><br><span class="line">      <span class="keyword">const</span> _ShowSecretMessageIntent.F(),</span><br><span class="line">    LogicalKeySet(LogicalKeyboardKey.keyO):</span><br><span class="line">      <span class="keyword">const</span> _ShowSecretMessageIntent.O(),</span><br><span class="line">    LogicalKeySet(LogicalKeyboardKey.keyR):</span><br><span class="line">      <span class="keyword">const</span> _ShowSecretMessageIntent.R(),</span><br><span class="line">    LogicalKeySet(LogicalKeyboardKey.keyM):</span><br><span class="line">      <span class="keyword">const</span> _ShowSecretMessageIntent.M(),</span><br><span class="line">    &#125;;</span><br><span class="line">  _actionMap = &lt;<span class="built_in">Type</span>, Action&lt;Intent&gt;&gt;&#123;</span><br><span class="line">    _ShowSecretMessageIntent: CallbackAction&lt;_ShowSecretMessageIntent&gt;(</span><br><span class="line">      onInvoke: _actionHandler,</span><br><span class="line">    ),</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>動作處理程序將鍵盤輸入連結到應用程式中的特定函數。每次按下字元時，都會在應用程式的主要部分加入一個展開的容器。但在您的應用程式中，您可以將其用於更具創意目的：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> _actionHandler(_ShowSecretMessageIntent intent) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (intent.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> _SecretMessageType.P:</span><br><span class="line">      setState(() &#123;</span><br><span class="line">        children.add(</span><br><span class="line">          Expanded(</span><br><span class="line">            child: Container(</span><br><span class="line">              color: Colors.orange,</span><br><span class="line">              child: Text(<span class="string">&#x27;Press L&#x27;</span>),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        );</span><br><span class="line">      &#125;);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">    …</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="焦點輸入"><a href="#焦點輸入" class="headerlink" title="焦點輸入"></a>焦點輸入</h3><p><code>FocusableActionDetector</code> Widget 允許您在指定 Widget 獲得焦點時執行動作呼叫。</p>
<p>焦點樹允許您使用 Tab 鍵在應用程式中瀏覽。這讓有視力障礙的人能夠瀏覽您的網站。</p>
<p><code>FocusableActionDetector</code> 子 Widget 被選為初始焦點，當其作用域中的其他節點目前沒有焦點時。如果您希望您的自訂鍵盤輸入在子 Widget 是否有焦點都不受影響的情況下運作，則將 <code>autofocus</code> 參數變數設定為 <code>true</code> 很重要。這是因為，預設情況下，此 <code>FocusableActionDetector</code> Widget 將不會獲得焦點，因此您將無法使用自訂鍵盤輸入：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FocusableActionDetector(</span><br><span class="line">  autofocus: <span class="keyword">true</span>,</span><br><span class="line">  child : …</span><br><span class="line">),</span><br></pre></td></tr></table></figure>

<p>假設您希望子 Widget 在獲得焦點時具有不同的顏色，以識別此 Widget 目前是否有焦點。如果您需要在 Widget 獲得焦點時設定自訂動作，請使用 <code>onShowFocusHighlight</code> 屬性。</p>
<p><a href="https://dartpad.dev/5544c57e20454fe212e3ec5cf10b1f0a">DartPad #2</a> 範例展示了如何使用 <code>onShowFocusHighlight</code> 屬性。</p>
<p>焦點是一個進階主題。透過閱讀 <a href="https://api.flutter.dev/flutter/widgets/Focus-class.html">Focus</a> 類別的 API 文件，您可以進一步了解焦點。</p>
<h3 id="懸停輸入"><a href="#懸停輸入" class="headerlink" title="懸停輸入"></a>懸停輸入</h3><p><code>FocusableActionDetector</code> Widget 允許您處理懸停輸入。這樣一來，每當游標懸停在特定 Widget 上時，就會發生自訂動作。與 <code>onShowFocusHighlight</code> 屬性類似，<code>onShowHoverHighlight</code> 屬性讓您能夠在滑鼠游標懸停在特定 Widget 上時建立自訂動作。</p>
<p>查看 <a href="https://dartpad.dev/5544c57e20454fe212e3ec5cf10b1f0a">DartPad #2</a> 範例，它展示了如何實作自訂懸停和焦點動作。</p>
<p>在 <a href="https://dartpad.dev/5544c57e20454fe212e3ec5cf10b1f0a">DartPad #2</a> 範例中，每當滑鼠懸停在 Widget 上時，它就會更改 Widget 的顏色。如果您使用 Tab 鍵在應用程式中瀏覽，您會注意到，與目前被懸停的 Widget 相比，獲得焦點的 Widget 會對 Widget 應用不同的陰影。</p>
<p>這意味著您可以在 Widget 獲得焦點或滑鼠游標懸停在該 Widget 上時，執行不同的自訂動作。如果您將滑鼠懸停在同一個 Widget 上並使它獲得焦點，您就可以看出來。該 Widget 會同時對該 Widget 應用兩個陰影。若要了解更多資訊，請查看 <a href="https://api.flutter.dev/flutter/widgets/FocusableActionDetector-class.html">FocusableActionDetector</a> 類別的 API 文件。</p>
<h3 id="自訂滑鼠游標"><a href="#自訂滑鼠游標" class="headerlink" title="自訂滑鼠游標"></a>自訂滑鼠游標</h3><p><code>FocusableActionDetector</code> Widget 讓您能夠實作自訂滑鼠游標。例如，如果您希望使用者知道特定 Widget 是可拖曳的，更改滑鼠游標是一個很好的指示，表示您可以執行此操作。<code>FocusableActionDetector</code> Widget 具有 <code>mouseCursor</code> 參數。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mouseCursor: SystemMouseCursors.grabbing</span><br></pre></td></tr></table></figure>

<p><a href="https://dartpad.dev/d16345202d0e26d40fe14904657dc24a">DartPad #1</a> 範例展示了 Flutter 中不同類型的滑鼠游標。點擊應用程式列中的任何圖示以嘗試使用。有九種不同的系統預設滑鼠游標：</p>
<ol>
<li><code>SystemMouseCursors.basic</code></li>
<li><code>SystemMouseCursors.text</code></li>
<li><code>SystemMouseCursors.click</code></li>
<li><code>SystemMouseCursors.forbidden</code></li>
<li><code>SystemMouseCursors.grab</code></li>
<li><code>SystemMouseCursors.grabbing</code></li>
<li><code>SystemMouseCursors.horizontalDoubleArrow</code>（未在穩定版本中）</li>
<li><code>SystemMouseCursors.verticalDoubleArrow</code>（未在穩定版本中）</li>
<li><code>SystemMouseCursors.none</code></li>
</ol>
<h3 id="結語"><a href="#結語" class="headerlink" title="結語"></a>結語</h3><p>在 Flutter 中，您可以存取網頁特定 API。<code>FocusableActionDetector</code> Widget 讓您能夠在 Flutter 中處理網頁特定功能。若要進一步了解 Flutter 網頁，請查看 Medium 文章 <a href="https://medium.com/flutter/handling-404-page-not-found-error-in-flutter-731f5a9fba29">Handling 404: Page not found error in Flutter</a>。</p>
<p><em>關於作者：Jose 最近從大學畢業，現在在 <a href="https://material.io/">Material</a> 工作，這是一個幫助團隊構建高品質數位體驗的設計系統。Jose 的團隊維護 Flutter 的 <a href="https://api.flutter.dev/flutter/material/material-library.html">material 函式庫</a>。若要了解更多資訊，請訪問 Jose 在 <a href="https://github.com/JoseAlba">GitHub</a>、<a href="https://www.linkedin.com/in/josealba1996/">LinkedIn</a>、<a href="https://www.youtube.com/channel/UCOdKA_On0oPe1tz02z1QfxA?view_as=subscriber">YouTube</a> 和 <a href="https://www.instagram.com/jose.alba/">Instagram</a> 上的頁面。</em></p>
<p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=e16946a04745" width="1" height="1" alt=""><hr><p><a href="https://medium.com/flutter/handling-web-gestures-in-flutter-e16946a04745">在 Flutter 中處理網頁手勢</a> 最初發佈在 <a href="https://medium.com/flutter">Flutter</a> 上的 Medium，人們在那裡透過突出顯示和回應這個故事來繼續討論。</p> </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw,default">
    <link itemprop="mainEntityOfPage" href="https://blog.rainvisitor.me/archives/a3b110e7.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rainvisitor">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RainVisitor Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/archives/a3b110e7.html" class="post-title-link" itemprop="url">【文章翻譯】Supporting iOS 14 and Xcode 12 with Flutter</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-16 17:39:09" itemprop="dateCreated datePublished" datetime="2020-09-16T17:39:09+08:00">2020-09-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-09-30 16:55:14" itemprop="dateModified" datetime="2024-09-30T16:55:14+08:00">2024-09-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Flutter/" itemprop="url" rel="index"><span itemprop="name">Flutter</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>【文章內容使用 Gemini 1.5 Pro 自動產生】</p>
<h2 id="使用-Flutter-支援-iOS-14-和-Xcode-12"><a href="#使用-Flutter-支援-iOS-14-和-Xcode-12" class="headerlink" title="使用 Flutter 支援 iOS 14 和 Xcode 12"></a>使用 Flutter 支援 iOS 14 和 Xcode 12</h2><p>與往常一樣，我們的目標是讓開發人員在 Flutter 上取得成功，無論您要鎖定的平台為何。自 6 月宣布 iOS 14 以來，我們一直在努力為 Flutter 加入支援此版本的新功能，包括更新 <a href="https://github.com/flutter/flutter/issues/60133">Xcode 12 支援</a>，以及加入支援 <a href="https://github.com/flutter/flutter/issues/61047">iOS 14</a> 的新功能和改進。</p>
<p>如果您的 iOS 14 應用程式使用 <a href="https://api.flutter.dev/flutter/material/TextField-class.html">TextField</a>、<a href="https://api.flutter.dev/flutter/cupertino/CupertinoTextField-class.html">CupertinoTextField</a> 或 <a href="https://api.flutter.dev/flutter/material/TextFormField-class.html">TextFormField</a>，您需要確保它使用 Flutter 1.20 或更高版本構建，以確保您的使用者不會受到不必要的剪貼簿通知訊息的困擾，這符合 Apple 更新的剪貼簿政策。</p>
<p><strong>否則，現有的生產應用程式將在您的終端使用者 iOS 14 設備上順利運行。</strong> 但是，如果您今天要將開發手機升級到 iOS 14 並希望繼續與 Flutter 一起使用它，您有兩個選擇。</p>
<p>您的第一個選擇是使用穩定頻道上的 <a href="https://github.com/flutter/flutter/wiki/Hotfixes-to-the-Stable-Channel">Flutter 最新修補程式版本</a> (1.20.4)，它支援將應用程式部署到實體 iOS 14 設備進行開發。不幸的是，還需要另一個更具侵入性（因此風險更大）的變更才能在 iOS 14 上進行除錯和熱重載。我們將此修復推遲到我們下一個穩定版本，我們計劃在下週釋出。</p>
<p>您的第二個選擇是使用我們今天釋出的即將到來的 Flutter 1.22 的 beta 版。此版本包含對 iOS 14 的更全面支援，包括更新的視覺效果、應用程式片段和 Xcode 12 支援。當它發佈到穩定頻道時，我們將分享更多關於其功能集的信息，但在此之前，我們建議您在需要立即支援 iOS 14 的情況下使用此 beta 版本。</p>
<p>若要取得 Flutter 1.22 beta 版，請使用以下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ flutter channel beta</span><br><span class="line">$ flutter upgrade</span><br></pre></td></tr></table></figure>

<p>無論哪種情況，您都需要查看 <a href="https://flutter.dev/docs/development/ios-14">針對 iOS 14 開發頁面</a>，以獲取有關使用 Flutter 鎖定 iOS 14 的有用資訊。如果您在 iOS 14 中遇到任何問題，請 <a href="https://github.com/flutter/flutter/issues">在 Flutter 儲存庫中提交議題</a>。如果您有任何問題，請在 <a href="https://groups.google.com/g/flutter-dev">flutter-dev 群組</a> 中發布。</p>
<p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=15fe0062e98b" width="1" height="1" alt=""><hr><p><a href="https://medium.com/flutter/supporting-ios-14-and-xcode-12-with-flutter-15fe0062e98b">使用 Flutter 支援 iOS 14 和 Xcode 12</a> 最初發佈在 <a href="https://medium.com/flutter">Flutter</a> 上的 Medium，人們在那裡透過突出顯示和回應這個故事來繼續討論。</p> </p>
<p><a href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw,default">
    <link itemprop="mainEntityOfPage" href="https://blog.rainvisitor.me/archives/44cfc921.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rainvisitor">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RainVisitor Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/archives/44cfc921.html" class="post-title-link" itemprop="url">【文章翻譯】Exploring collections in Dart</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-15 22:42:00" itemprop="dateCreated datePublished" datetime="2020-09-15T22:42:00+08:00">2020-09-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-26 19:28:05" itemprop="dateModified" datetime="2024-12-26T19:28:05+08:00">2024-12-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Dart/" itemprop="url" rel="index"><span itemprop="name">Dart</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>【文章內容使用 Gemini 1.5 Pro 自動翻譯產生】</p>
<h2 id="探索-Dart-中的集合"><a href="#探索-Dart-中的集合" class="headerlink" title="探索 Dart 中的集合"></a>探索 Dart 中的集合</h2><figure>
<img alt="" src="https://cdn-images-1.medium.com/max/1024/1*NLasdGsxG6bBzWYfe_9UJA.jpeg" />
</figure>

<p>如果您曾經調用 <code>add()</code>、<code>addAll()</code>、<code>map()</code> 或 <code>toList()</code> 來建立列表或映射，您可能需要查看 <em>collection if</em>、<em>collection for</em> 和 <em>spreads</em>。去年，Dart <a href="https://medium.com/dartlang/announcing-dart-2-3-optimized-for-building-user-interfaces-e84919ca1dff">在 2.3 版中加入了這些功能</a>。</p>
<p>在本文中，我們將研究集合，探索這些新功能，並查看一些有趣的範例。透過掌握這些功能，您可以使您的程式碼更簡潔、更易於閱讀。</p>
<h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><p>首先，我們需要了解什麼是集合。<a href="https://api.dart.dev/stable/dart-core/dart-core-library.html#collections">集合</a> 是一個包含其他物件的物件。例如：</p>
<ul>
<li><strong>List</strong>：具有長度的有序物件集合（也稱為 <em>陣列</em>）</li>
<li><strong>Set</strong>：唯一物件的無序集合</li>
<li><strong>Map</strong>：鍵值對的無序集合</li>
<li><strong>Queue</strong>：可以在兩端添加&#x2F;移除物件的有序集合</li>
<li><strong>SplayTreeMap</strong>：基於自平衡二元樹的鍵值對的有序集合</li>
</ul>
<p>這些類型在 <a href="https://api.dart.dev/stable/dart-collection/dart-collection-library.html"><code>dart:collection</code></a> 套件中可用。如需更多集合類型，請在 pub.dev 上查看 <a href="https://pub.dev/packages/collection">package:collection</a>。</p>
<p>這些集合類型都實作了 <a href="https://api.dart.dev/stable/dart-core/Iterable-class.html">Iterable</a>，它提供了一些常用行為，例如在集合中的每個物件上運行函數、獲取第一個物件、確定集合的長度等等。</p>
<h3 id="集合字面量"><a href="#集合字面量" class="headerlink" title="集合字面量"></a>集合字面量</h3><p>Dart 支援用於構造三種類型集合的語法：列表字面量 (<code>[]</code>)、映射字面量 (<code>&#123;&#125;</code>) 和集合字面量（也是 <code>&#123;&#125;</code>）。</p>
<p>以下是一個列表字面量：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; getArtists() &#123;</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="string">&#x27;Picasso&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Warhol&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Monet&#x27;</span>,</span><br><span class="line">  ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以下是一個映射字面量：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; getArtistsByPainting &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="string">&#x27;The Old Guitarist&#x27;</span>: <span class="string">&#x27;Picasso&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Orange Prince&#x27;</span>: <span class="string">&#x27;Warhol&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;The Water Lily Pond&#x27;</span>: <span class="string">&#x27;Monet&#x27;</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以下是一個集合字面量，在 Dart 2.3 中加入：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set</span>&lt;<span class="built_in">String</span>&gt; getArtistsSet() &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="string">&#x27;Picasso&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Warhol&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Monet&#x27;</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果您想知道為什麼映射和集合可以使用相同的 <code>&#123;&#125;</code> 語法，那是因為 Dart 使用 <a href="https://dart.dev/guides/language/type-system#type-inference">類型推斷</a> 來區分。類型系統根據參數 a 和 b 的類型確定類型。它通常可以根據內容確定這一點——例如，<code>&#123;1&#125;</code> 顯然是一個 <code>Set</code>，而 <code>&#123;1: 2&#125;</code> 顯然是一個 <code>Map</code>。</p>
<blockquote>
<p><strong>注意：</strong> 使用 <code>&#123;&#125;</code> 預設構造一個映射。要建立一個集合，您可以使用泛型類型註釋：<code>&lt;String&gt;&#123;&#125;</code>。使用兩個泛型類型參數則建立一個映射：<code>&lt;String, String&gt;&#123;&#125;</code>。</p>
</blockquote>
<h3 id="元素的類型"><a href="#元素的類型" class="headerlink" title="元素的類型"></a>元素的類型</h3><p>集合字面量中的每個項目通常是一個值或表達式，但也可以是以下新功能之一：<em>collection if</em>、<em>collection for</em> 或 <em>spread</em>。所有這些都被稱為 <em>元素</em>。</p>
<p>每個元素解包零個或多個項目，並將它們放入周圍的集合中。例如，一個字串字面量（例如「oatmeal」）會產生一個項目，但 <em>collection for</em> 會解包 0 個或多個項目。這些功能也可以以有趣的方式組合，我們將在下面探討。</p>
<h4 id="Spreads"><a href="#Spreads" class="headerlink" title="Spreads"></a>Spreads</h4><p><em>spread</em> 接收一個集合（例如，一個列表），並將其內容放入周圍的集合中：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; combineLists(<span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; a, <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; b) &#123;</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    ...a,</span><br><span class="line">    ...b,</span><br><span class="line">  ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>前面的程式碼相當於：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; combineLists(<span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; a, <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; b) &#123;</span><br><span class="line">  <span class="keyword">var</span> list = [];</span><br><span class="line">  list.addAll(a);</span><br><span class="line">  list.addAll(b);</span><br><span class="line">  <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>您也可以在映射和集合字面量中使用 spreads：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; combineMaps(<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; a, <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; b) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...a,</span><br><span class="line">    ...b,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set</span>&lt;<span class="built_in">String</span>&gt; combineSets(<span class="built_in">Set</span>&lt;<span class="built_in">String</span>&gt; a, <span class="built_in">Set</span>&lt;<span class="built_in">String</span>&gt; b) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...a,</span><br><span class="line">    ...b,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在映射和集合中，當發生衝突時，b 的內容會覆蓋 a 中的內容。例如，調用 <code>combineMaps(&#123;&#39;foo&#39;: &#39;bar&#39;&#125;, &#123;&#39;foo&#39;: &#39;baz&#39;&#125;)</code> 會產生一個包含 <code>&#123;&#39;foo&#39;: &#39;baz&#39;&#125;</code> 的映射。</p>
<h4 id="Null-aware-spreads-…"><a href="#Null-aware-spreads-…" class="headerlink" title="Null-aware spreads (…?)"></a>Null-aware spreads (…?)</h4><p><em>null-aware spread</em> 僅當運算符後的表達式為非 null 時才將內容加入到集合中：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; combineIfExists(<span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; a, <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; b) &#123;</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    ...?a,</span><br><span class="line">    ...?b,</span><br><span class="line">  ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">var</span> result = combineIfExists([<span class="string">&#x27;foo&#x27;</span>], <span class="keyword">null</span>);</span><br><span class="line">  <span class="built_in">print</span>(result); <span class="comment">// [foo]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Collection-if"><a href="#Collection-if" class="headerlink" title="Collection if"></a>Collection if</h4><p>使用 <code>if</code>、<code>else</code> 和 <code>else if</code> 關鍵字根據條件將某些內容加入到集合中。以下是一個使用 <em>collection if</em> 的範例：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span> </span>&#123;</span><br><span class="line">  <span class="built_in">String</span> title;</span><br><span class="line">  <span class="built_in">DateTime</span> date;</span><br><span class="line"></span><br><span class="line">  Article(<span class="keyword">this</span>.title, <span class="keyword">this</span>.date);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">String</span> toString() &#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">      <span class="keyword">if</span> (title != <span class="keyword">null</span>) title,</span><br><span class="line">      date.toString(),</span><br><span class="line">    ].join(<span class="string">&#x27;, &#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以在末尾加入 <code>else</code> 關鍵字：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> toString() &#123;</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">     <span class="keyword">if</span> (title != <span class="keyword">null</span>) title <span class="keyword">else</span> <span class="string">&#x27;(no title)&#x27;</span>,</span><br><span class="line">  ].join(<span class="string">&#x27;, &#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>請注意逗號的位置。逗號不能在 <code>title</code> 之後，因為 <code>else</code> 是同一個元素的一部分。將 <code>if</code> 和 <code>else</code> 保持在一起，在逗號之前，可以將它們與集合中的下一個元素區分開來。</p>
<p>加入 <code>else if</code> 也可以：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> toString() &#123;</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="keyword">if</span> (title != <span class="keyword">null</span>) title <span class="keyword">else</span> <span class="string">&#x27;(no title)&#x27;</span>,</span><br><span class="line">    <span class="keyword">if</span> (date == <span class="keyword">null</span>)</span><br><span class="line">      <span class="string">&#x27;(no date)&#x27;</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (date.year == <span class="built_in">DateTime</span>.now().year)</span><br><span class="line">      <span class="string">&#x27;this year&#x27;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="string">&#x27;<span class="subst">$&#123;date.year&#125;</span>&#x27;</span>,</span><br><span class="line">  ].join(<span class="string">&#x27;, &#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Collection-for"><a href="#Collection-for" class="headerlink" title="Collection for"></a>Collection for</h4><p>最後，使用 <code>for</code> 關鍵字將序列插入到集合中：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span> </span>&#123;</span><br><span class="line">  <span class="built_in">String</span> title;</span><br><span class="line">  <span class="built_in">DateTime</span> date;</span><br><span class="line">  <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; tags;</span><br><span class="line"></span><br><span class="line">  Article(<span class="keyword">this</span>.title, <span class="keyword">this</span>.date, <span class="keyword">this</span>.tags);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">String</span> toString() &#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">      title,</span><br><span class="line">      date.toString(),</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> tag <span class="keyword">in</span> tags) <span class="string">&#x27;tag: <span class="subst">$tag</span>&#x27;</span></span><br><span class="line">    ].join(<span class="string">&#x27;, &#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在此範例中，<code>for</code> 表達式為 <code>tags</code> 列表中的每個項目加入一個字串。就像 Dart 中的普通 <code>for</code> 迴圈一樣，<code>tags</code> 表達式可以是任何 <code>Iterable</code>。</p>
<h3 id="Flutter-程式碼中的集合"><a href="#Flutter-程式碼中的集合" class="headerlink" title="Flutter 程式碼中的集合"></a>Flutter 程式碼中的集合</h3><p>如果您正在使用 Dart，很有可能您正在<a href="https://www.zdnet.com/article/googles-flutter-2-million-developers-uptick-in-enterprise-use-new-release-model-revealed/">使用它來構建 Flutter 應用程式</a>。由於這裡描述的功能是<a href="https://github.com/munificent/ui-as-code/blob/master/Motivation.md">在設計時考慮到 Flutter 的</a>，讓我們來看看一些 Flutter 程式碼。</p>
<h4 id="重構-build-方法"><a href="#重構-build-方法" class="headerlink" title="重構 build() 方法"></a>重構 build() 方法</h4><p>在 Flutter 中，通常在 <code>build()</code> 方法中構建 Widget 列表：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">  <span class="keyword">var</span> articleWidgets = articles</span><br><span class="line">      .map&lt;Widget&gt;((article) =&gt; ArticleWidget(article: article))</span><br><span class="line">      .toList();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ListView(</span><br><span class="line">    children: articleWidgets,</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以使用 <em>spread</em> 重寫此程式碼：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ListView(</span><br><span class="line">    children: [</span><br><span class="line">      ...articles.map((article) =&gt; ArticleWidget(article:article))</span><br><span class="line">    ],</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者使用 <em>collection for</em>：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">  <span class="keyword">return</span> ListView(</span><br><span class="line">    children: [</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> article <span class="keyword">in</span> articles)</span><br><span class="line">        ArticleWidget(article: article)</span><br><span class="line">    ],</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第一個程式碼片段使用 <code>map()</code> 將 <code>Article</code> 類別轉換為 <code>ArticleWidget</code> 物件的集合，然後應用 <em>spread</em> 運算符將它們展開到周圍的列表中。在第二個範例中，<em>collection for</em> 運算符讓您可以更簡潔地表達這一點。</p>
<h4 id="更大的-build-方法"><a href="#更大的-build-方法" class="headerlink" title="更大的 build() 方法"></a>更大的 build() 方法</h4><p>以下是一個更複雜的範例：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">  <span class="keyword">var</span> headerStyle = Theme.of(context).textTheme.headline4;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Column(</span><br><span class="line">    children: [</span><br><span class="line">      <span class="keyword">if</span> (article.title != <span class="keyword">null</span>)</span><br><span class="line">        Text(article.title, style: headerStyle),</span><br><span class="line">      <span class="keyword">if</span> (article.date != <span class="keyword">null</span>)</span><br><span class="line">        Text(article.date.toString()),</span><br><span class="line">      Text(<span class="string">&#x27;Tags:&#x27;</span>),</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> tag <span class="keyword">in</span> article.tags)</span><br><span class="line">        Text(tag),</span><br><span class="line">    ],</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>放置 Widget 到 <code>Column</code> 中的邏輯就在讀者可能期望的位置，並且節省了大量程式碼。在這些功能出現之前，實現相同行為最常用的方法是建立一個變數，並使用調用 <code>add()</code> 的普通 <code>if</code> 陳述式。</p>
<h3 id="組合這些功能"><a href="#組合這些功能" class="headerlink" title="組合這些功能"></a>組合這些功能</h3><p>這些功能可以以有趣的方式組合，如本節中的範例所示。以下是一些需要注意的事項：</p>
<ul>
<li>從語法上講，<em>collection if</em>、<em>collection for</em> 或 <em>spread</em> 是一個 <em>單個元素</em>——即使它最終建立了多個物件。</li>
<li>任何表達式都可以放在 <em>collection if</em> 或 <em>collection for</em> 的主體中。</li>
<li>任何 <em>元素</em> 都可以放在 <em>collection if</em> 或 <em>collection for</em> 的主體中。</li>
</ul>
<h4 id="結合使用-if-和-for"><a href="#結合使用-if-和-for" class="headerlink" title="結合使用 if 和 for"></a>結合使用 if 和 for</h4><p>以下是一些使用 <em>collection for</em> 內部的 <em>collection if</em> 建立列表的程式碼。在這裡，如果每個文章的日期晚於特定日期，則將其加入到列表中：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;Article&gt; recentArticles(<span class="built_in">List</span>&lt;Article&gt; allArticles) &#123;</span><br><span class="line">  <span class="keyword">var</span> ninetyDaysAgo = <span class="built_in">DateTime</span>.now().subtract(<span class="built_in">Duration</span>(days: <span class="number">90</span>));</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> article <span class="keyword">in</span> allArticles)</span><br><span class="line">      <span class="keyword">if</span> (article.date.isAfter(ninetyDaysAgo))</span><br><span class="line">        article</span><br><span class="line">  ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果您更喜歡 spreads，則返回值可以寫成 <code>...allArticles.where((article) =&gt; article.date.isAfter(ninetyDaysAgo))</code>。</p>
<h4 id="將-collection-if-和-spreads-結合使用"><a href="#將-collection-if-和-spreads-結合使用" class="headerlink" title="將 collection if 和 spreads 結合使用"></a>將 collection if 和 spreads 結合使用</h4><p><em>collection if</em> 接收單個元素，但如果您想包含多個元素，則可以使用 <em>spread</em>：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">  <span class="keyword">return</span> Column(</span><br><span class="line">    children: [</span><br><span class="line">      <span class="keyword">if</span> (article.date != <span class="keyword">null</span>) ...[</span><br><span class="line">        Icon(Icons.calendar_today),</span><br><span class="line">        Text(<span class="string">&#x27;<span class="subst">$&#123;article.date&#125;</span>&#x27;</span>),</span><br><span class="line">      ],</span><br><span class="line">    ],</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="將集合功能與-async-await-結合使用"><a href="#將集合功能與-async-await-結合使用" class="headerlink" title="將集合功能與 async-await 結合使用"></a>將集合功能與 async-await 結合使用</h4><p>您也可以將非同步調用與集合字面量結合使用。例如，一個常見的模式是使用 <code>Future.wait()</code> 觸發一組非同步調用：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;Article&gt; fetchArticle(<span class="built_in">String</span> id);</span><br><span class="line"></span><br><span class="line">Future&lt;<span class="built_in">List</span>&lt;Article&gt;&gt; fetchArticles() <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> Future.wait([</span><br><span class="line">    fetchArticle(<span class="string">&#x27;1&#x27;</span>),</span><br><span class="line">    fetchArticle(<span class="string">&#x27;2&#x27;</span>),</span><br><span class="line">    fetchArticle(<span class="string">&#x27;3&#x27;</span>),</span><br><span class="line">  ]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以使用 <em>collection for</em> 改進該程式碼：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;<span class="built_in">List</span>&lt;Article&gt;&gt; fetchArticles(<span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; ids) <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> Future.wait([</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> id <span class="keyword">in</span> ids)</span><br><span class="line">      fetchArticle(id),</span><br><span class="line">  ]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也可以在集合字面量中放入 <code>await</code>，儘管它會依次等待每個 <code>Future</code>：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;<span class="built_in">List</span>&lt;Article&gt;&gt; fetchArticles(<span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; ids) <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="comment">// 一次獲取一個</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> id <span class="keyword">in</span> ids)</span><br><span class="line">      <span class="keyword">await</span> fetchArticle(id),</span><br><span class="line">  ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>前面的程式碼會依次等待，因為它相當於以下程式碼：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;<span class="built_in">List</span>&lt;Article&gt;&gt; fetchArticles() <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &lt;Article&gt;[</span><br><span class="line">    <span class="comment">// 一次獲取一個</span></span><br><span class="line">    <span class="keyword">await</span> fetchArticle(<span class="string">&#x27;1&#x27;</span>),</span><br><span class="line">    <span class="keyword">await</span> fetchArticle(<span class="string">&#x27;2&#x27;</span>),</span><br><span class="line">    <span class="keyword">await</span> fetchArticle(<span class="string">&#x27;3&#x27;</span>),</span><br><span class="line">  ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>您也可以使用 <code>await for</code> 展開 <code>Stream</code>：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;<span class="built_in">String</span>&gt; <span class="keyword">get</span> idStream =&gt; Stream.fromIterable([<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>]);</span><br><span class="line">Future&lt;<span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt;&gt; gatherIds(Stream&lt;<span class="built_in">String</span>&gt; ids) <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">for</span> (<span class="keyword">var</span> id <span class="keyword">in</span> ids)</span><br><span class="line">      id</span><br><span class="line">  ];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="keyword">await</span> gatherIds(idStream)); <span class="comment">// [1, 2, 3]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>這是 <em>collection if</em>、<em>collection for</em> 和 <em>spreads</em> 如何與語言的其他部分一起使用的另一個範例。如果您使用過 <code>await for</code> 陳述式，您可能會猜到其行為：它偵聽 <code>Stream</code> 中的新值，並將主體放入周圍的列表中。</p>
<h3 id="進一步探索"><a href="#進一步探索" class="headerlink" title="進一步探索"></a>進一步探索</h3><p>希望這些技巧能幫助您編寫更乾淨的 Dart 程式碼。除了這裡提到的之外，還有更多使用這些功能的方法。如果您發現了一個好的技巧，請<a href="https://dart.dev/community">與社群分享</a>或<a href="https://twitter.com/dart_lang">在 Twitter 上提及 <em>@dart_lang</em></a>。如需更多詳細資訊，請查看<a href="https://medium.com/dartlang/making-dart-a-better-language-for-ui-f1ccaf9f546c">使 Dart 成為更好的 UI 語言</a>或 GitHub 上的初始<a href="https://github.com/dart-lang/language/blob/master/accepted/2.3/unified-collections/feature-specification.md">語言提案</a>。</p>
<p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=f66b6a02d0b1" width="1" height="1" alt=""><hr><p><a href="https://medium.com/dartlang/exploring-collections-in-dart-f66b6a02d0b1">探索 Dart 中的集合</a> 最初發佈在 <a href="https://medium.com/dartlang">Dart</a> 上的 Medium，人們在那裡透過突出顯示和回應這個故事來繼續討論。</p></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw,default">
    <link itemprop="mainEntityOfPage" href="https://blog.rainvisitor.me/archives/dd9d00ec.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rainvisitor">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RainVisitor Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/archives/dd9d00ec.html" class="post-title-link" itemprop="url">【文章翻譯】Google Summer of Code 2020 results</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-02 15:51:09" itemprop="dateCreated datePublished" datetime="2020-09-02T15:51:09+08:00">2020-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-26 19:28:05" itemprop="dateModified" datetime="2024-12-26T19:28:05+08:00">2024-12-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Dart/" itemprop="url" rel="index"><span itemprop="name">Dart</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>【文章內容使用 Gemini 1.5 Pro 自動翻譯產生】</p>
<h2 id="Google-暑期程式碼計畫-2020-成果"><a href="#Google-暑期程式碼計畫-2020-成果" class="headerlink" title="Google 暑期程式碼計畫 2020 成果"></a>Google 暑期程式碼計畫 2020 成果</h2><figure>
<img alt="Google Summer of Code" src="https://cdn-images-1.medium.com/max/680/1*5VxyyQ1juWjwtTbSkwzzXA.jpeg" />
</figure>

<p><a href="https://summerofcode.withgoogle.com/">Google 暑期程式碼計畫 (GSoC)</a> 是一個全球性的計畫，旨在讓學生開發者參與開放原始碼軟體開發。Google 贊助學生在暑假期間與一個指導性的開放原始碼組織合作，進行為期 3 個月的程式設計專案。</p>
<p>在 <a href="https://medium.com/dartlang/students-join-a-dart-project-for-google-summer-of-code-2020-655d39b557c2">二月</a>，我們很興奮地宣布 Dart 團隊將成為 2020 年 GSoC 的指導組織。我們最終 <a href="https://summerofcode.withgoogle.com/organizations/6544944065413120/">指導了 5 個專案</a>，這些專案是從來自世界各地學生的 170 多份申請中選出的。今天，我們很高興與大家分享我們的成果，這些成果將由參與專案的學生們來描述。</p>
<h3 id="使用-package-ffigen-為-Dart-C-互通性產生-dart-ffi-繫結"><a href="#使用-package-ffigen-為-Dart-C-互通性產生-dart-ffi-繫結" class="headerlink" title="使用 package:ffigen 為 Dart-C 互通性產生 dart:ffi 繫結"></a>使用 package:ffigen 為 Dart-C 互通性產生 dart:ffi 繫結</h3><p><em>Prerak Mann</em></p>
<p><a href="https://pub.dev/packages/ffigen">package:ffigen</a> 是一個 FFI 產生器，它透過從 C 標頭檔 (.h) 產生 Dart 繫結，大大減少了使用 dart:ffi 的工作量。</p>
<p>為了理解這個工具的需求，請考慮 <a href="https://clang.llvm.org/doxygen/group__CINDEX.html">LibClang</a>（Clang 的 C 介面）。LibClang 的 <a href="https://github.com/dart-lang/ffigen/tree/master/third_party/libclang/include/clang-c">API</a> 大約有 8,000 行程式碼 (LOC)。如果您要手動為 LibClang 編寫 Dart <a href="https://github.com/dart-lang/ffigen/blob/master/example/libclang-example/generated_bindings.dart">繫結</a>，您將需要將近 4,500 LOC。使用 package:ffigen，您只需傳入一個小於 20 LOC 的 <a href="https://github.com/dart-lang/ffigen/blob/master/example/libclang-example/pubspec.yaml#L14">小型 YAML 設定檔</a>，然後就可以產生繫結。</p>
<p>您可以控制要產生的 C 函式，並使用簡單的正規表示式來重新命名巨集、列舉和個別的結構成員。您也可以 <a href="https://github.com/dart-lang/ffigen#array-workaround">產生</a> 巢狀在結構中的陣列成員（dart:ffi 中尚不完全支援）。</p>
<p>請查看 <a href="https://github.com/dart-lang/ffigen">github.com&#x2F;dart-lang&#x2F;ffigen</a> 以取得完整的 <a href="https://github.com/dart-lang/ffigen#configurations">設定</a>、<a href="https://github.com/dart-lang/ffigen#faq">常見問題</a>、<a href="https://github.com/dart-lang/ffigen/blob/master/example/">範例</a> 等等。</p>
<h3 id="使用新的-Flutter-範例學習測試"><a href="#使用新的-Flutter-範例學習測試" class="headerlink" title="使用新的 Flutter 範例學習測試"></a>使用新的 Flutter 範例學習測試</h3><p><em>Abdullah Deshmukh</em></p>
<p>您已經使用 Flutter 一段時間了，但仍然不知道如何測試 Flutter 應用程式嗎？那麼您可能會對我們建立的範例感興趣，該範例展示了測試 Flutter 應用程式的最佳實踐。您將能夠快速輕鬆地學習在 Flutter 中進行測試。</p>
<p>該 <a href="https://github.com/flutter/samples/tree/master/testing_app">範例</a> 展示了不同類型的測試，包括：</p>
<ul>
<li>單元測試</li>
<li>Widget 測試</li>
<li>整合測試</li>
<li>效能測試</li>
<li>狀態管理測試</li>
</ul>
<p>作為額外福利，我們還建立了一個關於如何測試 Flutter 應用程式的程式碼實驗室。您可以在文章 <a href="https://medium.com/flutter/learn-testing-with-the-new-flutter-sample-gsoc20-work-product-e872c7f6492a">使用新的 Flutter 範例學習測試</a> 中查看專案下完成工作的詳細報告。</p>
<h3 id="使用者可擴展的翻譯檔案格式"><a href="#使用者可擴展的翻譯檔案格式" class="headerlink" title="使用者可擴展的翻譯檔案格式"></a>使用者可擴展的翻譯檔案格式</h3><p><em>Jaime Blasco</em></p>
<p><a href="https://pub.dev/packages/intl_translation">intl_translation</a> 套件僅支援 ARB 檔案格式，該格式在 Dart 之外並未廣泛使用。在 GSoC 2020 期間建立的 <a href="https://pub.dev/packages/intl_translation_format">intl_translation_format</a> 套件建基於 intl_translation，並添加了一個 TranslationFormat 類別，可以支援各種不同的格式。開發人員可以在自己的套件中添加對其他格式的支援，並且只需幾行程式碼即可建立與現有工具整合的提取和產生命令列工具。有了這些，其他格式（即使是專有格式）的現有翻譯可以輕鬆匯入到 Dart 專案中，並且源自 Dart 程式碼的新訊息可以整合到現有的翻譯工具和工作流程中。</p>
<p>作為這些功能的展示，新的套件包含對多種格式的支援。除了 ARB 之外，它還支援 <strong>XLIFF v1.2 (iOS)、XLIFF v2.0</strong> 和 <strong>帶有 ICU 訊息的 JSON</strong>。<a href="https://github.com/jamesblasco/intl_translation_format_experiments">實驗性函式庫</a> 展示了如何實作對其他格式的支援，甚至是可以在執行階段更新的翻譯。</p>
<h3 id="行動應用程式和聯合-Plugin-中的平台通道"><a href="#行動應用程式和聯合-Plugin-中的平台通道" class="headerlink" title="行動應用程式和聯合 Plugin 中的平台通道"></a>行動應用程式和聯合 Plugin 中的平台通道</h3><p><em>Ayush Bherwani</em></p>
<p>在研究了平台通道（用於在 Dart 與原生程式碼（如 Swift 或 Kotlin）之間來回傳送訊息的 Flutter API）之後，我們決定使用兩個不同的範例來介紹這個主題。一個是 <a href="https://github.com/flutter/samples/tree/master/platform_channels">簡單的 Android 和 iOS 範例</a>，而另一個是 <a href="https://github.com/flutter/samples/tree/master/experimental/federated_plugin">聯合 Plugin</a>，能夠使用主頻道為 Web 和桌面建構。在這兩個範例之間，程式碼庫不僅展示了平台通道和用於移動資料的編解碼器的詳細資訊，還展示了聯合 Plugin 的 API 以及在 Web 和桌面（Windows 和 Linux）API 上調用原生程式碼的技術。</p>
<p>如果您是一位正在尋找建構 Plugin 或僅存取平台 API 的開發人員，這些範例是開始學習的好地方。有關此專案的更多資訊，請參閱文章 <a href="https://medium.com/flutter/platform-channel-examples-7edeaeba4a66">平台通道範例</a>。</p>
<h3 id="編寫-package-yaml-edit-以啟用-pub-add"><a href="#編寫-package-yaml-edit-以啟用-pub-add" class="headerlink" title="編寫 package:yaml_edit 以啟用 pub add &lt;package&gt;"></a>編寫 package:yaml_edit 以啟用 <code>pub add &lt;package&gt;</code></h3><p><em>Garett Tok Ern Liang</em></p>
<p>Dart 專案在 pubspec.yaml 檔案中指定套件依賴項。<a href="https://yaml.org/spec/1.2/spec.html">YAML</a> 很好，因為它允許我們編寫註釋，但是以程式設計方式修改 YAML 是一個挑戰。</p>
<p>為了應對這一挑戰，我們編寫了 <a href="https://pub.dev/packages/yaml_edit">package:yaml_edit</a> 以輕鬆執行上下文感知的字串操作，從而保留格式和註釋。該套件的測試套件包含超過 40,000 個測試，我們認為我們有一個非常好的解決方案。試用它並 <a href="https://github.com/google/dart-neats/issues">提交錯誤</a>！</p>
<p>使用 package:yaml_edit，我們在 pub（Dart 和 Flutter 的套件管理工具）中添加了一個新的子命令 <code>pub add &lt;package&gt;</code>。<code>pub add</code> 會自動解析目標套件的最新相容版本，並將其添加到使用者的 pubspec.yaml 中。具體來說，<code>pub add &lt;package&gt;</code> 自動化了以下所有操作的繁瑣過程：</p>
<ol>
<li>訪問 <a href="https://pub.dev/packages/">https://pub.dev/packages/</a><package></li>
<li>選擇要添加到套件的版本</li>
<li>修改 pubspec.yaml</li>
<li>執行 pub get</li>
<li>根據需要重複步驟 2-4 多次，以獲得與其他依賴項相容的版本</li>
</ol>
<p>一個類似的移除依賴項的命令 - <code>pub remove &lt;package&gt;</code> - 也正在開發中。請密切關注即將在 pub 中推出的這兩個命令！</p>
<blockquote>
<p>非常感謝所有向 Dart 申請 Google 暑期程式碼計畫 2020 的人，以及今年完成專案的學生，以及每週花時間讓這個夏天成為一個很棒的程式碼夏天的導師。我們希望在整個 Dart 生態系統中再次見到你們這些學生作為貢獻者。</p>
</blockquote>
<p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=a38cd072c9fe" width="1" height="1" alt=""><hr><p><a href="https://medium.com/dartlang/google-summer-of-code-2020-results-a38cd072c9fe">Google 暑期程式碼計畫 2020 成果</a> 最初發佈在 <a href="https://medium.com/dartlang">Dart</a> 上的 Medium，人們在那裡透過突出顯示和回應這個故事來繼續討論。</p></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw,default">
    <link itemprop="mainEntityOfPage" href="https://blog.rainvisitor.me/archives/4e57f386.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rainvisitor">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RainVisitor Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/archives/4e57f386.html" class="post-title-link" itemprop="url">【文章翻譯】Introducing a brand new pub.dev</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-15 15:01:02" itemprop="dateCreated datePublished" datetime="2020-07-15T15:01:02+08:00">2020-07-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-26 19:28:05" itemprop="dateModified" datetime="2024-12-26T19:28:05+08:00">2024-12-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Dart/" itemprop="url" rel="index"><span itemprop="name">Dart</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>【文章內容使用 Gemini 1.5 Pro 自動翻譯產生】</p>
<h2 id="隆重推出全新的-pub-dev"><a href="#隆重推出全新的-pub-dev" class="headerlink" title="隆重推出全新的 pub.dev"></a>隆重推出全新的 pub.dev</h2><p>今天，我們推出了全新的 <a href="https://pub.dev/">pub.dev</a> 網站。它採用了新的評分指標，讓您可以更好地了解可能有用的套件，並為套件發布者提供更多可操作的回饋，以提高套件品質。為了幫助您找到支援您感興趣的所有平台的套件，我們新增了識別和搜尋多平台套件的功能。總體而言，我們重新設計了使用者介面，目標是提供與我們的 <a href="https://dart.dev/">dart.dev</a> 和 <a href="https://dartpad.dev/">dartpad.dev</a> 網站一致的愉悅而優雅的體驗。</p>
<figure>
<img alt="A screenshot of the page at https://pub.dev" src="https://cdn-images-1.medium.com/max/1024/0*efALL34OP6a4tcxh" />
<figcaption>全新的 pub.dev 網站</figcaption>
</figure>

<h3 id="找到最符合您需求的套件"><a href="#找到最符合您需求的套件" class="headerlink" title="找到最符合您需求的套件"></a>找到最符合您需求的套件</h3><p>在過去一年中發布了近 7,000 個新套件，在尋找擴展應用程式功能的套件時，您不乏選擇。但是有這麼多套件可供選擇，您自然希望最受歡迎、品質最高、最常用的套件能夠脫穎而出。為了支援更好的套件搜尋結果，我們圍繞三個維度重新設計了 pub.dev 中的評分系統：</p>
<figure>
<img alt="Screenshot of a package summary: 552 likes; 100/110 pub points; 98% popularity" src="https://cdn-images-1.medium.com/max/1024/0*OmvIh_FRHtJDrSIk" />
<figcaption>pub 套件的三個評分維度</figcaption>
</figure>

<ol>
<li><strong>點讚數</strong>: 衡量有多少開發者點讚了一個套件。這提供了一個對套件整體評價的原始指標。</li>
<li><strong>Pub 分數</strong>: 一種新的品質衡量標準。這包括品質的幾個維度，例如程式碼風格、平台支援和可維護性。詳情請見下文。</li>
<li><strong>熱門度</strong>: 衡量有多少開發者使用一個套件。這反映了过去六十天內依賴該套件的應用程式數量。標準化後的評分範圍從 100%（最常用的套件）到 0%（最少使用的套件），但我們正在研究是否可以在未來版本中提供絕對使用計數。</li>
</ol>
<p>我們希望這些新的維度可以幫助正在尋找依賴套件的套件使用者，以及致力於發布高品質套件的套件發布者。</p>
<h3 id="使用-Pub-分數衡量品質"><a href="#使用-Pub-分數衡量品質" class="headerlink" title="使用 Pub 分數衡量品質"></a>使用 Pub 分數衡量品質</h3><p>點讚數和熱門度提供了社群提供的、主觀的衡量標準，Pub 分數的目標是提供一個可衡量的、客觀品質的近似值。這並不容易；開發者以各種方式感知品質，但我們仍然相信大多數開發者都在尋找我們可以衡量的核心特徵。以前的 pub.dev 評分模型基於對問題的扣分。新的評分模型扭轉了這種方法，而是根據五個類別中的特徵授予分數：</p>
<figure>
<img alt="Screenshot: Pub points overview for a package" src="https://cdn-images-1.medium.com/max/1024/0*RWVQoe0INHUfS_Ax" />
<figcaption>Pub 分數概述，包含類別和檢查，以及獲得的分數</figcaption>
</figure>

<ol>
<li><em>遵循 Dart 檔案規範</em>: 遵循 pubspec、readme 和 changelog 檔案的最佳實務</li>
<li><em>提供文件</em>: 提供 API 文件和說明性範例</li>
<li><em>支援多個平台</em>: 支援盡可能多的 Dart 和 Flutter 平台</li>
<li><em>通過靜態分析</em>: 提供無錯誤、警告和 lint 的程式碼</li>
<li><em>支援最新的相依</em>: 具有支援最新 Dart 和 Flutter SDK 以及最新套件相依的相依限制</li>
</ol>
<p>我們預計隨著時間的推移，會為 Pub 分數新增更多檢查和類別，提高套件可以獲得的分數上限。例如，我們計劃在該功能推出時，為支援 <a href="https://medium.com/dartlang/announcing-sound-null-safety-defd2216a6f3">空安全</a> 新增一個分數。我們正在研究如何衡量可維護性（問題和拉取請求的回應速度）、可測試性（自動化測試覆蓋率）和社群友好度（貢獻者、維護者數量等）。如果您對一個好的衡量標準有任何想法，我們很樂意 <a href="https://github.com/dart-lang/pub-dev/issues">聽取您的意見</a>！</p>
<h3 id="支援多平台應用程式"><a href="#支援多平台應用程式" class="headerlink" title="支援多平台應用程式"></a>支援多平台應用程式</h3><p>Dart 和 Flutter 都擅長建立針對多個平台的應用程式。在 pub.dev 上，我們為行動（iOS 和 Android）和 Web 平台提供了清晰的平台標籤，以及這些平台的搜尋篩選器：</p>
<figure>
<img alt="Screenshot: Search results for Flutter packages that support both Android and Web" src="https://cdn-images-1.medium.com/max/1024/0*aTIl5H_AbGmOJBKO" />
<figcaption>搜尋中的平台篩選器</figcaption>
</figure>

<p>為了確保您的套件標記了正確的平台支援，請遵循 pub.dev <a href="https://pub.dev/help/scoring">評分說明頁面</a> 上的指南。</p>
<p>當桌面平台（macOS、Windows 和 Linux）發展到更最終的狀態時，我們將新增類似的支援。目前，您可以在「進階」搜尋選項中找到這些平台的篩選器：</p>
<figure>
<img alt="Screenshot: Search results for Flutter packages that support Android, iOS, and macOS platforms" src="https://cdn-images-1.medium.com/max/1024/0*LpResE7zZv_5x3xB" />
<figcaption>進階篩選器中的桌面平台</figcaption>
</figure>

<h3 id="優雅而令人愉悅的設計"><a href="#優雅而令人愉悅的設計" class="headerlink" title="優雅而令人愉悅的設計"></a>優雅而令人愉悅的設計</h3><p>Dart pub.dev 團隊與我們的內部創意團隊 Google Developer Studio 合作，Jeremy Sie 擔任主要設計師。除了功能更新之外，團隊還仔細研究了視覺設計，分享了他們對該專案的想法。為了提供一致的、易於存取的、以使用者為中心的體驗，我們根據 Google 的 <a href="https://material.io/design/">Material Design 系統</a> 進行了一系列改進。我們的目標是建立一個輕量級且簡化的介面，為套件發布者和使用者提供清晰簡潔的工作流程。</p>
<p>更新後的設計採用了 <a href="https://material.io/components">Material 元件</a>，例如卡片和晶片，可以清晰地顯示套件詳細資訊，並讓單個套件的功能更加透明。我們更新了排版系統，並改進了整個網站的 <a href="https://material.io/design/typography/the-type-system.html#type-scale">字體比例</a>，使搜尋結果更加清晰，並改進了套件資訊的顯示方式。套件分數等元件也經過重新設計，使其更加清晰，並以一種使評分過程更加透明且更容易理解的方式進行組織。</p>
<figure>
<img alt="Screenshot: Package search results" src="https://cdn-images-1.medium.com/max/1024/0*6UWz21c0wZuisozR" />
<figcaption>搜尋顯示所有三個 pub.dev 分數</figcaption>
</figure>

<p>我們還對首頁進行了更改。我們知道快速搜尋套件的能力是網站的核心部分，但我們希望透過顯示最有用的工具和函式庫來改進體驗。我們在前面加入了「Flutter 精選」和「最熱門套件」等區塊，幫助您快速瀏覽一些最好的套件。我們仔細研究了調色板和藝術方向，加入了插圖，並使程式碼範例等元件與 <a href="https://dart.dev/">dart.dev</a> 和 <a href="https://dartpad.dev/">dartpad.dev</a> 在視覺上保持一致。</p>
<h3 id="立即試用-pub-dev"><a href="#立即試用-pub-dev" class="headerlink" title="立即試用 pub.dev"></a>立即試用 pub.dev</h3><p>我們邀請您立即試用新的 <a href="http://pub.dev/">pub.dev</a> 瀏覽和搜尋體驗，並使用新的評分維度和 Pub 分數報告。</p>
<p>如果您是套件開發者，我們鼓勵您查看套件的 Pub 分數，尋找改進套件的機會。有關評分系統如何運作的更多詳細資訊，請參閱 <a href="https://pub.dev/help/scoring">pub.dev 評分說明</a>。</p>
<p>與往常一樣，我們喜歡回饋。請在下方留言，或在 <a href="https://github.com/dart-lang/pub-dev/issues">pub.dev 問題追蹤器</a> 中提交問題。</p>
<p><em>作者：Michael Thomsen（Dart 產品經理）和 Jeremy Sie（Google Developer Studio 視覺設計師）</em></p>
<p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=747406dcb486" width="1" height="1" alt=""><hr><p><a href="https://medium.com/dartlang/pub-dev-redesign-747406dcb486">隆重推出全新的 pub.dev</a> 最初發佈於 <a href="https://medium.com/dartlang">Dart</a> 上的 Medium，人們在那裡透過突出顯示和回應這個故事來繼續討論。</p></p>
<p><a href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw,default">
    <link itemprop="mainEntityOfPage" href="https://blog.rainvisitor.me/archives/7f23cbe8.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rainvisitor">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RainVisitor Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/archives/7f23cbe8.html" class="post-title-link" itemprop="url">【文章翻譯】Dart string manipulation done right </a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-06-30 20:25:58" itemprop="dateCreated datePublished" datetime="2020-06-30T20:25:58+08:00">2020-06-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-26 19:28:05" itemprop="dateModified" datetime="2024-12-26T19:28:05+08:00">2024-12-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Dart/" itemprop="url" rel="index"><span itemprop="name">Dart</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>【文章內容使用 Gemini 1.5 Pro 自動翻譯產生】</p>
<h2 id="正確操作-Dart-字串-👉"><a href="#正確操作-Dart-字串-👉" class="headerlink" title="正確操作 Dart 字串 👉"></a>正確操作 Dart 字串 👉</h2><p>像許多其他在表情符號開始主導我們的日常通訊和多語言支援在商業應用程式中興起之前設計的程式語言一樣，Dart 將字串表示為 <a href="https://api.dart.dev/stable/2.8.4/dart-core/String-class.html">UTF-16 編碼單元序列</a>。這種編碼在大多數情況下都能正常工作，直到國際化的加強和伴隨任何語言出現的表情符號的引入，使得該編碼的固有問題成為每個人的問題。</p>
<p>考慮這個例子：</p>
<figure>
<img alt="The image shows the string “Hello” with a handwaving emoji at the end and it’s UTF-16 code units. The emoji takes two units." src="https://cdn-images-1.medium.com/max/1024/1*H_-SP7V6x1cQpGM_6DUReg.png" />
</figure>

<p>在字串 “Hello👋” 中，除了揮手表情符號 👋 之外，每個使用者可感知的字元都映射到一個編碼單元。這種映射的直接後果是對該字串長度的混淆。以下程式碼行的輸出是 6 還是 7？</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Hello👋&#x27;</span>.length);</span><br></pre></td></tr></table></figure>

<p>對於使用者來說，這個字串中顯然有 6 個字元，除非你進行哲學思考。但 Dart String API 會告訴你 <a href="https://api.dart.dev/stable/dart-core/String/length.html">長度</a> 是 7，或者更準確地說，是 7 個 UTF-16 編碼單元。這種差異會產生各種各樣的後果，因為許多文字操作任務都涉及到使用 String API 的字元索引。例如，”Hello👋”[5] 不會返回 👋 表情符號。相反，它會返回一個表示表情符號第一個編碼單元的錯誤字元。</p>
<p>好消息是，Dart 有一個名為 <a href="https://pub.dev/packages/characters">characters</a> 的新套件，它操作使用者可感知的字元，而不是 UTF-16 編碼單元。但是，作為 Dart 程式設計師，您需要知道何時使用 <code>characters</code> 套件。我們的研究表明，即使是經驗豐富的 Dart 程式設計師在閱讀文字操作程式碼時也很容易忽略此類問題。在本文中，我將介紹一些常見的場景，在這些場景中您需要注意並考慮使用 <code>characters</code> 套件而不是 Dart String。</p>
<h3 id="需要注意的場景"><a href="#需要注意的場景" class="headerlink" title="需要注意的場景"></a>需要注意的場景</h3><p>在本節中，我將介紹一些常見的文字操作場景，解釋為什麼在這些場景中使用 Dart 的 String API 可能會導致問題，並展示如何使用 <code>characters</code> 套件獲得更可靠的結果。以下用例通常假設我們正在處理人類使用者輸入的字串，其中可能包含表情符號或應用程式開發人員未預期的語言的字元。</p>
<h4 id="場景-1：計算字串中的字元數"><a href="#場景-1：計算字串中的字元數" class="headerlink" title="場景 1：計算字串中的字元數"></a>場景 1：計算字串中的字元數</h4><p>假設您正在撰寫一個函數，用於檢查使用者輸入的文字是否超過了特定數量的字元。如果未達到限制，則該函數返回剩餘字元的正數；如果超過了限制，則返回額外字元的負數。</p>
<p>使用 String API 執行此操作非常簡單：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> remainingCharacters(<span class="built_in">String</span> text, <span class="built_in">int</span> limit) &#123;</span><br><span class="line">  <span class="keyword">return</span> limit - text.length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是，以下測試揭示了此程式碼的問題：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&#x27;remainingCharacters emoji&#x27;</span>, () &#123;</span><br><span class="line">  expect(remainingCharacters(<span class="string">&#x27;How are you doing today 😀&#x27;</span>, <span class="number">50</span>), <span class="number">47</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>以下是測試結果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Expected: &lt;47&gt;</span><br><span class="line">  Actual: &lt;46&gt;</span><br></pre></td></tr></table></figure>

<p>我們可以使用 <code>characters</code> 套件重寫此函數，該套件在 String 上提供了一個方便的擴展方法，以產生正確的字元數，如下所示：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> remainingCharacters(<span class="built_in">String</span> text, <span class="built_in">int</span> limit) &#123;</span><br><span class="line">  <span class="keyword">return</span> limit - text.characters.length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="場景-2：擷取子字串"><a href="#場景-2：擷取子字串" class="headerlink" title="場景 2：擷取子字串"></a>場景 2：擷取子字串</h4><p>在此場景中，我們想要實作一個函數，該函數從字串中刪除最後一個字元並將結果作為新字串返回。讓我們假設此字串來自使用者輸入。</p>
<p>使用 String 上的 <code>substring</code> 方法可以輕鬆實作此函數，如下所示：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> deleteLastCharacter(<span class="built_in">String</span> text) &#123;</span><br><span class="line">  <span class="keyword">return</span> text.substring(<span class="number">0</span>, text.length - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是，一個好的表情符號測試可以快速破壞程式碼：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&#x27;deleteLastCharacter emoji&#x27;</span>, () &#123;</span><br><span class="line">  expect(deleteLastCharacter(<span class="string">&#x27;Hi 🇩🇪&#x27;</span>), <span class="string">&#x27;Hi &#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>以下是測試結果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Expected: ‘Hi ’</span><br><span class="line">  Actual: ‘Hi 🇩???’</span><br><span class="line">    Which: is different. Both strings start the same, but the actual value also has the following trailing characters: 🇩???</span><br></pre></td></tr></table></figure>

<p><code>characters</code> 套件可以輕鬆處理這種情況，因為它提供了高階方法，例如 <a href="https://pub.dev/documentation/characters/latest/characters/Characters/skipLast.html">skipLast(int count)</a>。我們可以將此程式碼片段重寫為以下程式碼：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> deleteLastCharacter(<span class="built_in">String</span> text) &#123;</span><br><span class="line">  <span class="keyword">return</span> text.characters.skipLast(<span class="number">1</span>).toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="場景-3：根據表情符號分割字串"><a href="#場景-3：根據表情符號分割字串" class="headerlink" title="場景 3：根據表情符號分割字串"></a>場景 3：根據表情符號分割字串</h4><p>在第三個場景中，我們想要根據給定的表情符號分割字串。以下是一個使用 String 上的 <code>split</code> 方法執行此操作的函數：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; splitString(<span class="built_in">String</span> text, <span class="built_in">String</span> emoji) &#123;</span><br><span class="line">  <span class="keyword">return</span> text.split(emoji);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>它會起作用嗎？它可能在 99% 的情況下都能正常工作，但以下測試說明了一個例子，其中上面的程式碼產生了相當令人驚訝的結果。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&#x27;splitString emoji&#x27;</span>, () &#123;</span><br><span class="line">  expect(splitString(<span class="string">&#x27;abc👨‍👩‍👧‍👦abc abc abc&#x27;</span>, <span class="string">&#x27;👨‍👩‍👧‍👦&#x27;</span>), [<span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;abc&#x27;</span>]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>以下是測試結果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Expected: [&#x27;abc👨‍👩‍👧‍👦&#x27;, &#x27;abc&#x27;, &#x27;abc&#x27;, &#x27;abc&#x27;]</span><br><span class="line">  Actual: [&#x27;abc👨‍👩‍&#x27;, &#x27;‍👦&#x27;, &#x27;abc&#x27;, &#x27;abc&#x27;, &#x27;abc&#x27;]</span><br><span class="line">    Which: was &#x27;abc👨‍👩‍&#x27; instead of &#x27;abc👨‍👩‍👧‍👦&#x27; at location [0]</span><br></pre></td></tr></table></figure>

<p>那麼，為什麼當字串被分割時，👨‍👩‍👧‍👦 變成了兩個表情符號 👨‍👩？這是因為 👨‍👩‍👧‍👦 實際上由四個不同的表情符號組成：👨👩👧👦。當字串在 👧 上被分割時，“abc👨‍👩‍👧‍👦” 被分成了兩部分：“abc👨‍👩” 和 “‍👦”。</p>
<p>您可以透過使用 Characters 類別上的 <a href="https://pub.dev/documentation/characters/latest/characters/Characters/split.html">split</a> 方法來避免此問題，如下列程式碼所示：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; splitString(<span class="built_in">String</span> text, <span class="built_in">String</span> emoji) &#123;</span><br><span class="line">  <span class="keyword">return</span> text.characters.split(emoji.characters).map((e) =&gt; e.toString()).toList();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="場景-4：根據索引存取特定字元"><a href="#場景-4：根據索引存取特定字元" class="headerlink" title="場景 4：根據索引存取特定字元"></a>場景 4：根據索引存取特定字元</h4><p>在文字操作中，通常根據字串中的索引（即位置）存取特定字元。例如，以下程式碼片段顯示了一個函數，該函數從使用者在兩個單獨的文字欄位中輸入的名和姓中返回首字母縮寫：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> getInitials(<span class="built_in">String</span> firstName, <span class="built_in">String</span> lastName) &#123;</span><br><span class="line">  <span class="keyword">return</span> firstName[<span class="number">0</span>] + lastName[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是，正如我們在本文開頭所演示的那樣，在基於 UTF-16 的字串中使用索引可能會有風險。讓我們用以下測試案例驗證上述程式碼的正確性：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&#x27;getInitials accent&#x27;</span>, () &#123;</span><br><span class="line">  expect(getInitials(<span class="string">&#x27;Élise&#x27;</span>, <span class="string">&#x27;Boisson&#x27;</span>), <span class="string">&#x27;ÉB&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>以下是測試結果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Expected: ‘ÉB’</span><br><span class="line">  Actual: ‘EB’</span><br><span class="line">    Which: is different.</span><br></pre></td></tr></table></figure>

<p>為什麼測試失敗了？這是因為字母 “É” 可能是 “E” 和重音符號的組合。您可以使用 <code>characters</code> 套件輕鬆避免此問題：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> getInitials(<span class="built_in">String</span> firstName, <span class="built_in">String</span> lastName) &#123;</span><br><span class="line">  <span class="keyword">return</span> firstName.characters.first.toString() + lastName.characters.first.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="練習：省略文字溢位"><a href="#練習：省略文字溢位" class="headerlink" title="練習：省略文字溢位"></a>練習：省略文字溢位</h3><p>現在，這是一個挑戰。在此場景中，應用程式需要顯示訊息列表，每行顯示一條訊息。要求您檢查實作一個函數的程式碼，該函數在訊息長度超過給定字元限制時將文字溢位顯示為省略號。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> omitTextOverflow(<span class="built_in">String</span> text, <span class="built_in">int</span> limit) &#123;</span><br><span class="line">  <span class="keyword">if</span> (text.length &amp;lt;= limit) &#123;</span><br><span class="line">    <span class="keyword">return</span> text;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> text.substring(<span class="number">0</span>, limit - <span class="number">3</span>) + <span class="string">&#x27;...&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>您能否提出一個測試來揭示此程式碼片段的潛在問題？您將如何使用 <code>characters</code> 套件重寫它？答案在本文末尾。</p>
<h3 id="緩解措施和可能的長期解決方案"><a href="#緩解措施和可能的長期解決方案" class="headerlink" title="緩解措施和可能的長期解決方案"></a>緩解措施和可能的長期解決方案</h3><p>期望 Dart 使用者對上述陷阱保持高度警惕是不合理的。例如，在我們進行的一項實驗中，53.7% 的 Dart 使用者無法檢測到第一個場景（計算字元數）中說明的問題，即使他們在幾分鐘前收到了兩頁關於 <code>characters</code> 套件以及該套件旨在解決的問題的資訊。因此，我們正在採取兩階段方法來幫助開發人員為他們的文字操作需求選擇最合適的 API。</p>
<p>短期內，我們將在 Flutter 框架和 Dart 分析器中引入一組緩解措施，以使 <code>characters</code> 套件更容易在 Dart UI 程式設計中發現和調用。這涉及幾個步驟：</p>
<ol>
<li>在 TextField Widget 的內部實作中使用 <code>characters</code> 套件。有關更多詳細資訊，請參閱 <a href="https://github.com/flutter/flutter/pull/53381">此 PR</a> 和 <a href="https://docs.google.com/document/d/1OOFW0PEZf0orBl445YXJ3nfjyKOqZdmeQ6KU3glUh7s/edit">此設計文件</a>。</li>
<li>透過 Flutter 框架公開 <code>characters</code> 套件的 API。完成此操作後，Flutter 使用者將更有可能透過擴展方法 <a href="https://pub.dev/documentation/characters/latest/characters/StringCharacters.html">String.characters</a> 發現 API，該方法將在對 String 執行自動完成時顯示。此工作的狀態在此議題中追蹤：<a href="https://github.com/flutter/flutter/issues/55593">https://github.com/flutter/flutter/issues/55593</a>。</li>
<li>更新 Flutter 框架的 API 文件和範例程式碼，以建議在適用時使用 <a href="https://pub.dev/documentation/characters/latest/characters/Characters-class.html">Characters</a>  類別，例如在 <a href="https://api.flutter.dev/flutter/material/TextField/onChanged.html">TextField.onChanged</a> 的回調中。此工作在 <a href="https://github.com/flutter/flutter/issues/55598">https://github.com/flutter/flutter/issues/55598</a> 中追蹤，相關詳細資訊在 <a href="https://docs.google.com/document/d/18SxWeHpds4modnvo997vIOiq01EspeFgsNvPa5ey88w/edit#heading=h.1isiu2jji0ae">此文件</a> 中。</li>
<li>讓 Dart 分析器在自動完成用於處理使用者輸入文字的回調模板時建議將 String 物件轉換為 Characters 物件。例如，在使用者在 <code>onChanged</code> 上自動完成後，IDE 可以填寫以下程式碼片段中的所有內容。此工作在 <a href="https://github.com/dart-lang/sdk/issues/41677">https://github.com/dart-lang/sdk/issues/41677</a> 中追蹤。</li>
</ol>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">onChanged: (text) &#123;</span><br><span class="line">    <span class="keyword">final</span> characters = text.characters;</span><br><span class="line">    <span class="comment">// …</span></span><br><span class="line">&#125;,</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>這些緩解措施可以提供幫助，但它們僅限於在 Flutter 專案上下文中執行的字串操作。我們需要在它們可用後仔細衡量它們的有效性。Dart 語言層面更完整的解決方案可能需要遷移至少一些現有程式碼，儘管一些選項（例如，<a href="https://github.com/dart-lang/language/issues/42">靜態擴展類型</a>）<em>可能</em>會使重大變更易於管理。需要更多技術調查才能完全了解權衡取捨。</p>
<h3 id="如何提供幫助"><a href="#如何提供幫助" class="headerlink" title="如何提供幫助"></a>如何提供幫助</h3><p>請幫助我們提高對如何使用 <code>characters</code> 套件修復字串問題的認識：</p>
<ul>
<li>在您自己的程式碼中尋找使用 <code>String.length</code> 或 <code>String.substring</code> 的實例。如果字串可能源自使用者輸入，請嘗試使用 <code>characters</code> 套件重寫程式碼。</li>
<li>與 Dart 社群中的其他人分享這篇文章。</li>
<li>嘗試更新 StackOverflow 上關於 Dart 文字操作的 <a href="https://stackoverflow.com/search?q=%5Bdart%5D+or+%5BFlutter%5D+String">現有答案</a>。如果已接受的答案忽略了 String API 的此限制，請提醒人們注意風險。</li>
<li>對上面列出的 GitHub 議題發表評論，讓我們知道您的想法和意見。</li>
</ul>
<p>現在，祝您編碼愉快 😉！</p>
<h3 id="致謝"><a href="#致謝" class="headerlink" title="致謝"></a>致謝</h3><p>感謝 Kathy Walrath、Lasse Nielsen 和 Michael Thomson 審閱本文。我還要感謝參與我們使用者研究的開發人員。他們的參與幫助 Dart 和 Flutter 團隊更好地了解了處理 Dart String API 此限制的挑戰。</p>
<hr>
<p>PS：以下是練習的解決方案：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> omitTextOverflow(<span class="built_in">String</span> text, <span class="built_in">int</span> limit) &#123;</span><br><span class="line">  <span class="keyword">if</span> (text.characters.length &amp;lt;= limit) &#123;</span><br><span class="line">    <span class="keyword">return</span> text;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> text.characters.take(limit - <span class="number">3</span>).toString() + <span class="string">&#x27;...&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;omitTextOverflow doesn&#x27;t break emoji&quot;</span>, () &#123;</span><br><span class="line">    expect(omitTextOverflow(<span class="string">&quot;How are you doing today 😀&quot;</span>, <span class="number">20</span>), <span class="string">&quot;How are you doing...&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=5abd0668ba3e" width="1" height="1" alt=""><hr><p><a href="https://medium.com/dartlang/dart-string-manipulation-done-right-5abd0668ba3e">正確操作 Dart 字串 👉</a> 最初發佈在 <a href="https://medium.com/dartlang">Dart</a> 上的 Medium，人們在那裡透過突出顯示和回應這個故事來繼續討論。</p></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw,default">
    <link itemprop="mainEntityOfPage" href="https://blog.rainvisitor.me/archives/9735e3e.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rainvisitor">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RainVisitor Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/archives/9735e3e.html" class="post-title-link" itemprop="url">【文章翻譯】Handling 404: Page not found error in Flutter</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-06-10 22:13:20" itemprop="dateCreated datePublished" datetime="2020-06-10T22:13:20+08:00">2020-06-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-09-30 20:24:11" itemprop="dateModified" datetime="2024-09-30T20:24:11+08:00">2024-09-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Flutter/" itemprop="url" rel="index"><span itemprop="name">Flutter</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>【文章內容使用 Gemini 1.5 Pro 自動產生】</p>
<figure><img alt="" src="https://cdn-images-1.medium.com/max/850/1*eU-430nepv8cz3OYLIycng.png" /></figure>

<p>Flutter 釋出了網頁支援，允許您建立動態網站。Flutter 支援處理任何可能來自網頁使用的錯誤，例如 404 錯誤。但是，如何為您的 Flutter 應用程式製作自訂 404 頁面呢？</p>

<p>本文將說明如何建立在使用者導航到不存在的頁面時顯示的自訂頁面。</p>

<h3>如何在 Flutter 中將客戶端重新導向到自訂 404 頁面</h3>

<p>在瀏覽網際網路時，每個人都遇到過「404：頁面未找到錯誤」。Flutter 透過自動將您重新導向到初始路徑來處理此問題。這通常是您應用程式的首頁。但是，如果您想要像 [AirBnb](https://36bvmt283fg61unuud3h7qua-wpengine.netdna-ssl.com/wp-content/uploads/2013/03/airbnb-404.gif)、[GitHub](https://mamchenkov.net/wordpress/wp-content/uploads/2013/11/github-404.png) 甚至 [Flutter 網站](https://flutter.dev/foo) 那樣擁有華麗的 404 頁面該怎麼辦？您可以使用 Flutter 很輕鬆地做到這一點。</p>

<p>若要建立自訂 404 頁面，您的應用程式需要使用 MaterialApp、CupertinoApp 或 WidgetsApp Widget。大多數應用程式使用這三個 Widget 之一；它是在建立 Flutter 應用程式時呼叫的第一個 Widget。</p>

<p>MaterialApp 會將頂層 Navigator 組態設定為按以下順序搜尋路徑：</p>

<ol>
<li>對於 `/` 路徑，如果非空，則使用 [home](https://api.flutter.dev/flutter/material/MaterialApp/home.html) 屬性。</li>
<li>否則，如果它包含該路徑的條目，則使用 [routes](https://api.flutter.dev/flutter/material/MaterialApp/routes.html) 表格。</li>
<li>否則，如果提供，則呼叫 [onGenerateRoute](https://api.flutter.dev/flutter/material/MaterialApp/onGenerateRoute.html)。它應該為任何有效的路徑返回一個非空值，這些路徑未由 [home](https://api.flutter.dev/flutter/material/MaterialApp/home.html) 和 [routes](https://api.flutter.dev/flutter/material/MaterialApp/routes.html) 處理。</li>
<li>最後，如果所有其他方法都失敗了，則呼叫 [onUnknownRoute](https://api.flutter.dev/flutter/material/MaterialApp/onUnknownRoute.html)。</li>
</ol>

<p>如果您的路徑在這些表格中都沒有處理，則它使用 [onUnknownRoute](https://api.flutter.dev/flutter/material/MaterialApp/onUnknownRoute.html) 屬性來處理您的導航。此回呼通常用於錯誤處理。例如，此函數可能會始終產生一個「未找到」頁面，描述未找到的路徑。位置不明的路徑可能是由於應用程式中的錯誤或從 Android 意圖等外部請求推送路徑造成的。</p>

<p>以下範例程式碼演示如何為 onUnknownRoute 屬性定義一個匿名函數，該函數使用 RouteFactory，RouteFactory 是一個工廠方法，它以 RouteSettings 函數作為輸入，並返回一個 Route。以下程式碼片段顯示定義 onUnknownRoute 屬性可以多麼簡單：</p>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onUnknownRoute: (settings) &#123;</span><br><span class="line">  return MaterialPageRoute(builder: (_) =&gt; PageNotFound());</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>PageNotFound 是一個自訂 Widget，用於建立 404 頁面。此頁面可能會說明發生了什麼情況，並將使用者重新導向到首頁，但在建立 404 頁面時，您可以隨心所欲。</p>

<h3>結束語</h3>

<p>在建立 Flutter 應用程式時，重要的是要處理任何可能發生的問題。在 MaterialApp、CupertinoApp 或 WidgetApp 中使用 onUnknownRoute 屬性，可以讓您處理網站中不可避免的「頁面未找到」錯誤。</p>

<p>若要進一步了解 Flutter 中的路徑，請參閱 Medium 文章 [「使用命名路徑導航 URL 」](https://medium.com/flutter/flutter-web-navigating-urls-using-named-routes-307e1b1e2050)。</p>

<p><em>關於作者：Jose 最近從大學畢業，現在在 [Material](https://material.io) 工作，Material 是一個設計系統，幫助團隊建立高品質的數位體驗。Jose 的團隊維護 Flutter 的 [material 函式庫](https://api.flutter.dev/flutter/material/material-library.html)。若要進一步了解，請訪問 Jose 在 [GitHub](https://github.com/JoseAlba)、[LinkedIn](https://www.linkedin.com/in/josealba1996/)、[YouTube](https://www.youtube.com/channel/UCOdKA_On0oPe1tz02z1QfxA?view_as=subscriber) 和 [Instagram](https://www.instagram.com/jose.alba/) 上的頁面。</em></p>
<img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=731f5a9fba29" width="1" height="1"><hr><p><a href="https://medium.com/flutter/handling-404-page-not-found-error-in-flutter-731f5a9fba29">處理 Flutter 中的 404：頁面未找到錯誤</a> 最初發佈在 <a href="https://medium.com/flutter">Flutter</a> 上的 Medium，人們在那裡透過突出顯示和回應這個故事來繼續討論。</p> 

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw,default">
    <link itemprop="mainEntityOfPage" href="https://blog.rainvisitor.me/archives/f074a4db.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rainvisitor">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RainVisitor Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/archives/f074a4db.html" class="post-title-link" itemprop="url">【文章翻譯】Announcing sound null safety</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-06-10 16:00:36" itemprop="dateCreated datePublished" datetime="2020-06-10T16:00:36+08:00">2020-06-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-26 19:28:05" itemprop="dateModified" datetime="2024-12-26T19:28:05+08:00">2024-12-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Dart/" itemprop="url" rel="index"><span itemprop="name">Dart</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>【文章內容使用 Gemini 1.5 Pro 自動翻譯產生】</p>
<h2 id="宣告可靠的空值安全"><a href="#宣告可靠的空值安全" class="headerlink" title="宣告可靠的空值安全"></a>宣告可靠的空值安全</h2><p><em>作者：Filip Hracek 和 Michael Thomsen</em></p>
<p>今天，Dart 團隊迎來了一個重要的里程碑，我們推出了空值安全功能的技術預覽版。空值安全可以幫助您避免一類通常難以發現的錯誤，並且額外帶來一系列效能提升。我們現在發佈的是早期技術預覽版，期待您的回饋。</p>
<p>這篇文章描述了 Dart 團隊推出空值安全的計劃。它還解釋了<em>可靠的</em>空值安全是什麼意思，以及它與許多其他語言採用的方法有何不同。</p>
<h3 id="為什麼需要空值安全？"><a href="#為什麼需要空值安全？" class="headerlink" title="為什麼需要空值安全？"></a>為什麼需要空值安全？</h3><p>Dart 是一種型別安全語言。這意味著，當您取得某個型別的變數時，編譯器可以<em>保證</em>它是該型別的。但型別安全本身並不能保證變數不是空值。</p>
<p>空值錯誤非常常見。在 GitHub 上搜尋會發現由 Dart 程式碼中的空值引起的<a href="https://github.com/search?l=Dart&q=%22called+on+null%22&type=Issues">數千個問題</a>，以及更多<a href="https://github.com/search?l=Dart&q=%22called+on+null%22&type=Commits">數千個提交</a>試圖修復這些問題。</p>
<p>試著看看您是否可以在以下範例程式碼中發現可空性問題：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> printLengths(<span class="built_in">List</span>&lt;File&gt; files) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> file <span class="keyword">in</span> files) &#123;</span><br><span class="line">    <span class="built_in">print</span>(file.lengthSync());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果以空值呼叫此函式，它肯定會失敗，但還有第二種情況需要考慮：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="comment">// 錯誤情況 1：將空值傳遞給 files。</span></span><br><span class="line">  printLengths(<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 錯誤情況 2：傳遞檔案列表，其中包含一個空值項目。</span></span><br><span class="line">  printLengths([File(<span class="string">&#x27;filename1&#x27;</span>), File(<span class="string">&#x27;filename2&#x27;</span>), <span class="keyword">null</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>空值安全功能可以解決這個問題：</p>
<figure>
<img alt="" src="https://cdn-images-1.medium.com/max/1024/1*HKl1Jf0uBNP-gReYYcgC_g.png" />
</figure>

<p>有了空值安全，您可以更有信心地推斷您的程式碼。不再有煩人的執行階段空值解參考錯誤。相反，您會在編碼時得到靜態錯誤。</p>
<h3 id="可靠的空值安全"><a href="#可靠的空值安全" class="headerlink" title="可靠的空值安全"></a>可靠的空值安全</h3><p>Dart 的空值安全是<em>可靠的</em>。這意味著 Dart 可以 100% 確定在上面的範例中，<code>files</code> 列表及其中的元素都不能為空。當 Dart 分析您的程式碼並確定變數不可為空時，該變數<em>始終</em>不可為空：如果您在偵錯器中檢查正在執行的程式碼，您會看到不可空性在執行階段得以保留。相比之下，其他一些實作是不可靠的，並且在許多情況下仍然需要執行執行階段空值檢查。Dart 與 Swift 共享可靠的空值安全，但其他程式語言並不多。</p>
<p>Dart 的空值安全的可靠性還有另一個令人欣喜的含義：它意味著您的程式可以更小、更快。因為 Dart <em>確實</em>確定 <code>files</code> 永遠不會為空，所以 Dart 可以優化。例如，Dart ahead-of-time (AOT) 編譯器可以產生更小、更快的原生程式碼，因為當它<em>知道</em>變數不為空時，它不需要加入空值檢查。</p>
<p>我們已經看到一些非常有希望的初步結果。例如，在模擬典型 Flutter 架構渲染模式的微基準測試中，我們看到了 <a href="https://gist.github.com/a-siva/07e8a5bfa8548a3041d44d5d1c6f3a40">19% 的效能提升</a>。</p>
<h3 id="設計原則"><a href="#設計原則" class="headerlink" title="設計原則"></a>設計原則</h3><p>在開始詳細設計空值安全之前，Dart 團隊定義了以下三個核心原則：</p>
<ul>
<li><strong>預設不可為空。</strong> 除非您明確告訴 Dart 變數可以為空，否則它會將其視為不可為空。我們選擇此作為預設值，因為我們發現非空值是 API 中最常見的選擇。</li>
<li><strong>可逐步採用。</strong> 現有的 Dart 程式碼有很多。必須可以逐步遷移到空值安全，一部分一部分地遷移。在同一個專案中應該可以同時存在空值安全和非空值安全的程式碼。我們還將提供工具來幫助您進行遷移。</li>
<li><strong>完全可靠。</strong> 如上所述，Dart 的空值安全是可靠的。一旦您將整個專案和您的依賴項遷移到空值安全，您就可以獲得可靠性的全部好處。</li>
</ul>
<h3 id="使用空值安全宣告變數"><a href="#使用空值安全宣告變數" class="headerlink" title="使用空值安全宣告變數"></a>使用空值安全宣告變數</h3><p>核心語法很簡單。以下是一些以不同方式宣告的不可為空變數。記住，不可為空是預設值，因此這些宣告看起來和今天一樣，但它們的含義發生了變化。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在空值安全的 Dart 中，這些變數都不能為空。</span></span><br><span class="line"><span class="keyword">var</span> i = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">final</span> b = Foo();</span><br><span class="line"><span class="built_in">String</span> m = <span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>Dart 將確保您永遠不會將空值賦值給上述任何變數。如果您在一千行程式碼之後嘗試執行 <code>i = null</code>，您將收到靜態分析錯誤和紅色波浪線，並且您的程式將拒絕編譯。</p>
<p>如果您希望變數可以為空，您可以使用 <code>?</code>，如下所示：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 這些都是可為空的變數。</span></span><br><span class="line"><span class="built_in">int?</span> j = <span class="number">1</span>;  <span class="comment">// 之後可以為空。</span></span><br><span class="line"><span class="keyword">final</span> Foo? c = getFoo();  <span class="comment">// 函式可能傳回空值。</span></span><br><span class="line"><span class="built_in">String?</span> n;  <span class="comment">// 最初為空。之後的任何時候也可以為空。</span></span><br></pre></td></tr></table></figure>

<p>上述變數的行為與今天所有變數的行為相同。</p>
<p>您也可以在其他地方使用 <code>?</code> 語法：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在函式參數中。</span></span><br><span class="line"><span class="keyword">void</span> boogie(<span class="built_in">int?</span> count) &#123;</span><br><span class="line">  <span class="comment">// count 可能為空。</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在函式傳回值中。</span></span><br><span class="line">Foo? getFoo() &#123;</span><br><span class="line">  <span class="comment">// 可以傳回空值而不是 Foo。</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 也適用於：泛型、型別定義、型別檢查等。</span></span><br><span class="line"><span class="comment">// 以及上述的任何組合。</span></span><br></pre></td></tr></table></figure>

<p>但是，再次強調，我們的夢想是您幾乎永遠不需要使用 <code>?</code>。您的絕大多數型別都將是不可為空的。</p>
<h3 id="讓空值安全更容易使用"><a href="#讓空值安全更容易使用" class="headerlink" title="讓空值安全更容易使用"></a>讓空值安全更容易使用</h3><p>Dart 團隊正在努力讓空值安全盡可能容易使用。例如，看看這段使用 <code>if</code> 檢查空值的程式碼：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> honk(<span class="built_in">int?</span> loudness) &#123;</span><br><span class="line">  <span class="keyword">if</span> (loudness == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="comment">// 未指定 loudness，以最大 loudness 通知開發人員。</span></span><br><span class="line">    _playSound(<span class="string">&#x27;error.wav&#x27;</span>, volume: <span class="number">11</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// loudness 不為空，我們將其限制在可接受的級別。</span></span><br><span class="line">  _playSound(<span class="string">&#x27;honk.wav&#x27;</span>, volume: loudness.clamp(<span class="number">0</span>, <span class="number">11</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>請注意，Dart 如何聰明地意識到，當我們通過該 <code>if</code> 陳述句時，<code>loudness</code> 變數<em>不可能</em>為空。因此，Dart 允許我們直接呼叫 <code>clamp()</code> 方法，而無需額外操作。這種便利性是由一種稱為<em>流程分析</em>的東西實現的：Dart 分析器會像執行程式碼一樣瀏覽您的程式碼，自動找出有關程式碼的額外資訊。</p>
<p>以下是另一個範例，它顯示了一個 Dart 可以確定變數不為空的情況，因為我們總是為其賦值一個非空值：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> sign(<span class="built_in">int</span> x) &#123;</span><br><span class="line">  <span class="comment">// 結果不可為空。</span></span><br><span class="line">  <span class="built_in">int</span> result;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (x &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    result = <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    result = <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 到這裡，Dart 知道 result 不可能為空。</span></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果您移除上述任何賦值（例如，刪除 <code>result = -1;</code> 行），Dart 就無法保證 <code>result</code> 將不為空：您將收到靜態錯誤，並且您的程式碼將無法編譯。</p>
<p>流程分析僅在函式內部有效。如果您有一個全域變數或類別欄位，那麼 Dart 就無法保證何時會為其賦值什麼值。Dart 無法模擬整個應用程式的流程。因此，當您<em>知道</em>變數在第一次讀取之前將不為空，但您無法立即初始化它時，可以使用新的 <code>late</code> 關鍵字。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Goo</span> </span>&#123;</span><br><span class="line">  <span class="keyword">late</span> Viscosity v;</span><br><span class="line"></span><br><span class="line">  Goo(Material m) &#123;</span><br><span class="line">    v = m.computeViscosity();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>請注意，<code>v</code> 不可為空，儘管它最初未初始化。Dart 相信您在為 <code>v</code> 賦值一個非空值之前不會嘗試讀取它，並且您的程式碼可以編譯而不會出錯。</p>
<h3 id="空值安全向下相容"><a href="#空值安全向下相容" class="headerlink" title="空值安全向下相容"></a>空值安全向下相容</h3><p>Dart 團隊已經努力了一年多的時間，才讓空值安全進入技術預覽階段。這是自我們推出 Dart 2 以來，對 Dart 語言最大的補充。然而，它並不是一個重大變更。現有程式碼可以呼叫使用空值安全的程式碼，反之亦然。即使空值安全可用後，它也將是一個可選功能，您可以在準備就緒時採用。<strong>您現有的程式碼將繼續運行而不會發生變化</strong>。</p>
<p>我們最近將 Dart <a href="https://api.dart.dev/dev/2.9.0-13.0.dev/index.html">核心程式庫遷移到完全使用空值安全</a>。作為空值安全向下相容的一個範例，我們替換了現有的核心程式庫，而沒有在 Dart 和 Flutter 測試環境中運行的現有測試和測試應用程式中造成任何損壞。我們甚至將新的核心程式庫推送到我們在 Google 內部的許多客戶，直接推送到他們的生產程式碼庫中，也沒有出現任何問題。我們計劃在該功能推出時將我們所有的套件和應用程式遷移到使用空值安全，我們希望您也能這樣做。但您可以按照自己的時間表，逐個套件、逐個應用程式地進行遷移。</p>
<h3 id="空值安全路線圖"><a href="#空值安全路線圖" class="headerlink" title="空值安全路線圖"></a>空值安全路線圖</h3><p>我們計劃分三個階段逐步推出空值安全：</p>
<ol>
<li><strong>技術預覽。</strong> 這是<em>今天發佈</em>的，並且在 Dart 的 <a href="https://dart.dev/get-dart#release-channels">dev channel</a> 中可用。有關詳細資訊，請參閱下面的「立即試用」部分。事情仍然可能會發生變化，因此<strong>目前請勿在生產程式碼中使用空值安全</strong>。不過，請測試一下並 <a href="https://github.com/dart-lang/sdk/issues/new?title=Null%20safety%20feedback:%20%5Bissue%20summary%5D&labels=NNBD&body=Describe%20the%20issue%20or%20potential%20improvement%20in%20detail%20here">給我們回饋</a>！</li>
<li><strong>Beta 版。</strong> 空值安全將在 Dart 的 beta channel 中可用，並且不再需要 <a href="https://github.com/dart-lang/sdk/blob/master/docs/process/experimental-flags.md">實驗性標誌</a>。該功能將非常接近預期的最終版本。如果您擁有 <a href="https://pub.dev/">pub.dev</a> 套件或外掛，這是您可以開始遷移的時候，但您不應該將其發佈為穩定版本。</li>
<li><strong>穩定版。</strong> 每個人都將擁有空值安全，並且您將被鼓勵將您遷移的套件和外掛發佈為穩定版本。您還應該遷移您的生產應用程式。</li>
</ol>
<p>如果一切順利，我們計劃在今年年底之前將空值安全作為一個穩定功能發佈。從現在到那時，我們將加入工具來幫助您使您的程式碼空值安全，包括：</p>
<ul>
<li>一個遷移工具，以支援您自動執行升級現有套件和應用程式的許多步驟</li>
<li><a href="https://pub.dev/">pub.dev</a> 上的標籤，以便您可以判斷套件是否支援空值安全</li>
<li>對 <a href="https://dart.dev/tools/pub/cmd/pub-outdated"><code>pub outdated</code></a> 命令的擴展，支援尋找支援空值安全的最新版本的依賴項</li>
</ul>
<h3 id="立即試用"><a href="#立即試用" class="headerlink" title="立即試用"></a>立即試用</h3><p>今天試用空值安全的最快方法是透過 <a href="https://nullsafety.dartpad.dev/3d9c1769de7912c654bc5d132aff60ac">nullsafety.dartpad.dev</a>，這是一個啟用了空值安全的 DartPad 版本。打開「使用程式碼片段學習」下拉選單，可以找到一系列學習練習，逐步介紹空值安全的新語法和基礎知識。</p>
<figure>
<img alt="" src="https://cdn-images-1.medium.com/max/1024/0*7alHbKGJ1FoeNqII" />
</figure>

<p>您也可以在小型命令行程式中試用空值安全。（我們尚未遷移 Flutter 等較大的框架。）首先下載 <a href="https://github.com/dart-lang/samples/blob/master/null_safety/calculate_lix/README.md#dart-preview-sdk-installation">dev channel Dart SDK</a> 的副本，然後取得 <a href="https://github.com/dart-lang/samples/tree/master/null_safety/calculate_lix">此範例 Dart CLI 應用程式</a> 的副本（<a href="https://github.com/dart-lang/samples">GitHub 儲存庫</a>，<a href="https://github.com/dart-lang/samples/archive/master.zip">zip 壓縮檔案</a>）。範例應用程式的 <a href="https://github.com/dart-lang/samples/blob/master/null_safety/calculate_lix/README.md">README 檔案</a> 中包含使用空值安全實驗標誌運行應用程式的說明。範例中的其他檔案提供了在 VS Code 和 Android Studio 中啟用偵錯的啟動設定。</p>
<p>我們也有文件，並計劃製作更多：</p>
<ul>
<li><a href="https://dart.dev/null-safety">空值安全指南</a></li>
<li><a href="https://api.dart.dev/dev/2.9.0-13.0.dev/index.html">具有空值安全性的核心程式庫的 API 參考</a></li>
</ul>
<p>我們很高興將空值安全引入 Dart。可靠的空值安全是 Dart 的一個獨特功能，可以幫助您編寫更少錯誤的程式碼並獲得更好的效能。我們希望您在技術預覽中試用該功能，並透過我們的問題追蹤器 <a href="https://github.com/dart-lang/sdk/issues/new?title=Null%20safety%20feedback:%20%5Bissue%20summary%5D&labels=NNBD&body=Describe%20the%20issue%20or%20potential%20improvement%20in%20detail%20here">給我們回饋</a>。編碼愉快！</p>
<p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=defd2216a6f3" width="1" height="1" alt=""><hr><p><a href="https://medium.com/dartlang/announcing-sound-null-safety-defd2216a6f3">宣告可靠的空值安全</a> 最初發佈在 <a href="https://medium.com/dartlang">Dart</a> 上的 Medium，人們在那裡透過突出顯示和回應這個故事來繼續討論。</p></p>
<p><a href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/17/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><span class="page-number current">18</span><a class="page-number" href="/page/19/">19</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><a class="extend next" rel="next" href="/page/19/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Rainvisitor</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">245</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">239</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Rainvisitor</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
